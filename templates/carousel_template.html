<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carousel Templates</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/9.1.2/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600&family=Playfair+Display:wght@400;500;600;700&family=Space+Grotesk:wght@300;400;500;600;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: #f5f5f5;
            min-height: 100vh;
            padding: 0;
            margin: 0;
        }

        .preview-container {
            width: 100%;
            min-height: 100vh;
            background: white;
            overflow: hidden;
        }

        /* Common template styles */
        .template-base {
            padding: 40px;
            min-height: 100vh;
            line-height: 1.6;
            position: relative;
        }

        .template-base h1, .template-base h2, .template-base h3, 
        .template-base h4, .template-base h5, .template-base h6 {
            margin: 20px 0 15px 0;
            font-weight: 600;
        }

        .template-base p {
            margin-bottom: 18px;
        }

        .template-base ul, .template-base ol {
            margin: 20px 0;
            padding-left: 0;
        }

        .template-base li {
            list-style: none;
            margin: 12px 0;
            padding-left: 30px;
            position: relative;
        }

        .template-base pre {
            background: rgba(0,0,0,0.1);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            overflow-x: auto;
            font-family: 'JetBrains Mono', monospace;
        }

        .template-base code {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9em;
        }

        .template-base p code {
            background: rgba(0,0,0,0.1);
            padding: 3px 6px;
            border-radius: 4px;
        }

        .template-base table {
            width: 100%;
            border-collapse: collapse;
            margin: 25px 0;
            border-radius: 8px;
            overflow: hidden;
        }

        .template-base th, .template-base td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid;
        }

        .template-base th {
            font-weight: 600;
        }

        .template-base blockquote {
            margin: 20px 0;
            padding: 15px 20px;
            border-radius: 8px;
            font-style: italic;
            border-left: 4px solid;
        }

        .template-base a {
            text-decoration: none;
            font-weight: 500;
        }

        .template-base a:hover {
            text-decoration: underline;
        }

        .template-base hr {
            border: none;
            height: 2px;
            margin: 30px 0;
        }

        .template-base strong {
            font-weight: 700;
        }

        .template-base em {
            font-style: italic;
        }

        /* Tech Neural Template */
        .tech-neural-template {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-family: 'Space Grotesk', sans-serif;
        }

        .tech-neural-template::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 50%, rgba(255,255,255,0.1), transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255,255,255,0.08), transparent 50%);
            pointer-events: none;
        }

        .tech-neural-template > * {
            position: relative;
            z-index: 1;
        }

        .tech-neural-template h1 {
            font-size: 2.4rem;
            color: #ffffff;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .tech-neural-template h2 {
            font-size: 1.8rem;
            color: #e8f4fd;
            border-bottom: 2px solid rgba(255,255,255,0.3);
            padding-bottom: 8px;
        }

        .tech-neural-template h3 {
            font-size: 1.4rem;
            color: #d1ecf1;
        }

        .tech-neural-template li::before {
            content: 'â–¶';
            position: absolute;
            left: 0;
            color: #ffd700;
        }

        .tech-neural-template pre, .tech-neural-template p code {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            color: #e8f4fd;
        }

        .tech-neural-template table {
            background: rgba(255,255,255,0.1);
        }

        .tech-neural-template th {
            background: rgba(255,255,255,0.2);
            color: #ffffff;
        }

        .tech-neural-template th, .tech-neural-template td {
            border-bottom: 1px solid rgba(255,255,255,0.2);
        }

        .tech-neural-template blockquote {
            border-left-color: #ffd700;
            background: rgba(255,255,255,0.05);
        }

        .tech-neural-template strong {
            color: #ffd700;
        }

        .tech-neural-template a {
            color: #ffd700;
        }

        .tech-neural-template hr {
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
        }

        /* Tech Quantum Template */
        .tech-quantum-template {
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #16213e 100%);
            color: #00d4ff;
            font-family: 'JetBrains Mono', monospace;
        }

        .tech-quantum-template::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                repeating-linear-gradient(
                    90deg,
                    transparent,
                    transparent 100px,
                    rgba(0, 212, 255, 0.05) 100px,
                    rgba(0, 212, 255, 0.05) 101px
                );
            pointer-events: none;
        }

        .tech-quantum-template > * {
            position: relative;
            z-index: 1;
        }

        .tech-quantum-template h1 {
            font-size: 2.6rem;
            color: #00d4ff;
            text-shadow: 0 0 20px rgba(0, 212, 255, 0.5);
            font-family: 'Space Grotesk', sans-serif;
        }

        .tech-quantum-template h2 {
            font-size: 1.9rem;
            color: #ff006e;
            text-shadow: 0 0 15px rgba(255, 0, 110, 0.4);
        }

        .tech-quantum-template h3 {
            color: #8338ec;
        }

        .tech-quantum-template p {
            color: #b8c6db;
        }

        .tech-quantum-template li::before {
            content: '>';
            color: #00d4ff;
            font-weight: bold;
        }

        .tech-quantum-template pre, .tech-quantum-template p code {
            background: rgba(0, 212, 255, 0.1);
            border: 1px solid rgba(0, 212, 255, 0.3);
            color: #00d4ff;
        }

        .tech-quantum-template table {
            background: rgba(0, 212, 255, 0.05);
            border: 1px solid rgba(0, 212, 255, 0.2);
        }

        .tech-quantum-template th {
            background: rgba(0, 212, 255, 0.2);
            color: #ffffff;
        }

        .tech-quantum-template th, .tech-quantum-template td {
            border: 1px solid rgba(0, 212, 255, 0.2);
        }

        .tech-quantum-template blockquote {
            border-left-color: #ff006e;
            background: rgba(255, 0, 110, 0.05);
        }

        .tech-quantum-template strong {
            color: #ff006e;
        }

        .tech-quantum-template a {
            color: #8338ec;
        }

        .tech-quantum-template hr {
            background: linear-gradient(90deg, transparent, #00d4ff, transparent);
        }

        /* Product Modern Template */
        .product-modern-template {
            background: linear-gradient(135deg, #ff6b6b 0%, #feca57 100%);
            color: #2c3e50;
            font-family: 'Inter', sans-serif;
        }

        .product-modern-template::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 80% 20%, rgba(255,255,255,0.2), transparent 50%),
                radial-gradient(circle at 20% 80%, rgba(255,255,255,0.1), transparent 50%);
            pointer-events: none;
        }

        .product-modern-template > * {
            position: relative;
            z-index: 1;
        }

        .product-modern-template h1 {
            font-size: 2.8rem;
            font-weight: 800;
            color: #ffffff;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .product-modern-template h2 {
            font-size: 2rem;
            font-weight: 700;
            color: #2c3e50;
        }

        .product-modern-template h3 {
            color: #34495e;
        }

        .product-modern-template li::before {
            content: 'âœ“';
            color: #27ae60;
            font-weight: bold;
            font-size: 1.2rem;
        }

        .product-modern-template pre, .product-modern-template p code {
            background: rgba(255,255,255,0.8);
            border: 1px solid rgba(44, 62, 80, 0.2);
            color: #2c3e50;
        }

        .product-modern-template table {
            background: rgba(255,255,255,0.9);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .product-modern-template th {
            background: rgba(44, 62, 80, 0.8);
            color: #ffffff;
        }

        .product-modern-template th, .product-modern-template td {
            border-bottom: 1px solid rgba(44, 62, 80, 0.1);
        }

        .product-modern-template blockquote {
            border-left-color: #27ae60;
            background: rgba(255,255,255,0.6);
        }

        .product-modern-template strong {
            color: #e74c3c;
        }

        .product-modern-template a {
            color: #3498db;
        }

        .product-modern-template hr {
            background: linear-gradient(90deg, transparent, rgba(44, 62, 80, 0.3), transparent);
        }

        /* Product Premium Template */
        .product-premium-template {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: #ecf0f1;
            font-family: 'Playfair Display', serif;
        }

        .product-premium-template::before {
            content: '';
            position: absolute;
            top: 20px;
            left: 20px;
            right: 20px;
            bottom: 20px;
            border: 2px solid rgba(236, 240, 241, 0.2);
            border-radius: 15px;
            pointer-events: none;
        }

        .product-premium-template > * {
            position: relative;
            z-index: 1;
        }

        .product-premium-template h1 {
            font-size: 3rem;
            font-weight: 700;
            color: #f1c40f;
            text-align: center;
            font-family: 'Playfair Display', serif;
        }

        .product-premium-template h2 {
            font-size: 2.2rem;
            color: #e67e22;
            font-family: 'Playfair Display', serif;
        }

        .product-premium-template h3 {
            color: #95a5a6;
        }

        .product-premium-template p {
            font-family: 'Inter', sans-serif;
        }

        .product-premium-template li {
            font-family: 'Inter', sans-serif;
        }

        .product-premium-template li::before {
            content: 'â—†';
            color: #f1c40f;
        }

        .product-premium-template pre, .product-premium-template p code {
            background: rgba(236, 240, 241, 0.1);
            border: 1px solid rgba(241, 196, 15, 0.3);
            color: #f1c40f;
        }

        .product-premium-template table {
            background: rgba(236, 240, 241, 0.05);
        }

        .product-premium-template th {
            background: rgba(241, 196, 15, 0.2);
            color: #2c3e50;
            font-family: 'Inter', sans-serif;
        }

        .product-premium-template th, .product-premium-template td {
            border-bottom: 1px solid rgba(241, 196, 15, 0.2);
            font-family: 'Inter', sans-serif;
        }

        .product-premium-template blockquote {
            border-left-color: #e67e22;
            background: rgba(236, 240, 241, 0.05);
            font-family: 'Playfair Display', serif;
        }

        .product-premium-template strong {
            color: #f1c40f;
        }

        .product-premium-template a {
            color: #e67e22;
        }

        .product-premium-template hr {
            background: linear-gradient(90deg, transparent, #f1c40f, transparent);
        }

        /* Finance Gold Template */
        .finance-gold-template {
            background: linear-gradient(135deg, #f7931e 0%, #ffd700 100%);
            color: #2c3e50;
            font-family: 'Space Grotesk', sans-serif;
        }

        .finance-gold-template::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 10% 20%, rgba(255,255,255,0.3), transparent 40%),
                radial-gradient(circle at 90% 80%, rgba(255,255,255,0.2), transparent 40%);
            pointer-events: none;
        }

        .finance-gold-template > * {
            position: relative;
            z-index: 1;
        }

        .finance-gold-template h1 {
            font-size: 2.8rem;
            font-weight: 800;
            color: #1a1a1a;
            text-align: center;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .finance-gold-template h2 {
            font-size: 2rem;
            color: #8b4513;
            border-bottom: 3px solid #8b4513;
            padding-bottom: 8px;
        }

        .finance-gold-template h3 {
            color: #2c3e50;
        }

        .finance-gold-template p {
            font-weight: 500;
        }

        .finance-gold-template li::before {
            content: '$';
            color: #8b4513;
            font-weight: bold;
            font-size: 1.2rem;
        }

        .finance-gold-template pre, .finance-gold-template p code {
            background: rgba(0,0,0,0.1);
            border: 2px solid #8b4513;
            color: #2c3e50;
            font-weight: 600;
        }

        .finance-gold-template table {
            background: rgba(0,0,0,0.05);
            border: 2px solid #8b4513;
        }

        .finance-gold-template th {
            background: #8b4513;
            color: #ffd700;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .finance-gold-template th, .finance-gold-template td {
            border-bottom: 1px solid #8b4513;
            font-weight: 500;
        }

        .finance-gold-template blockquote {
            border-left-color: #8b4513;
            background: rgba(0,0,0,0.05);
            font-weight: 600;
        }

        .finance-gold-template strong {
            color: #8b4513;
            font-weight: 800;
        }

        .finance-gold-template a {
            color: #8b4513;
        }

        .finance-gold-template hr {
            background: linear-gradient(90deg, transparent, #8b4513, transparent);
        }

        /* Finance Elite Template */
        .finance-elite-template {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: #ffffff;
            font-family: 'Inter', sans-serif;
        }

        .finance-elite-template::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #ffd700, #ffffff, #ffd700);
        }

        .finance-elite-template::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #ffd700, #ffffff, #ffd700);
        }

        .finance-elite-template > * {
            position: relative;
            z-index: 1;
        }

        .finance-elite-template h1 {
            font-size: 2.6rem;
            color: #ffd700;
            text-align: center;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .finance-elite-template h2 {
            font-size: 2rem;
            color: #e8f4fd;
            border-left: 4px solid #ffd700;
            padding-left: 20px;
        }

        .finance-elite-template h3 {
            color: #b8dbd9;
        }

        .finance-elite-template li::before {
            content: 'â– ';
            color: #ffd700;
        }

        .finance-elite-template pre, .finance-elite-template p code {
            background: rgba(255, 215, 0, 0.1);
            border: 1px solid rgba(255, 215, 0, 0.3);
            color: #ffd700;
        }

        .finance-elite-template table {
            background: rgba(255, 215, 0, 0.05);
            border: 2px solid #ffd700;
        }

        .finance-elite-template th {
            background: #ffd700;
            color: #1e3c72;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .finance-elite-template th, .finance-elite-template td {
            border-bottom: 1px solid rgba(255, 215, 0, 0.3);
        }

        .finance-elite-template blockquote {
            border-left-color: #ffd700;
            background: rgba(255, 215, 0, 0.05);
            font-size: 1.1rem;
        }

        .finance-elite-template strong {
            color: #ffd700;
        }

        .finance-elite-template a {
            color: #e8f4fd;
        }

        .finance-elite-template hr {
            background: linear-gradient(90deg, transparent, #ffd700, transparent);
        }

        /* Health Care Template */
        .health-care-template {
            background: linear-gradient(135deg, #56ab2f 0%, #a8e6cf 100%);
            color: #2c3e50;
            font-family: 'Inter', sans-serif;
        }

        .health-care-template::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 30% 30%, rgba(255,255,255,0.2), transparent 40%),
                radial-gradient(circle at 70% 70%, rgba(255,255,255,0.15), transparent 40%);
            pointer-events: none;
        }

        .health-care-template > * {
            position: relative;
            z-index: 1;
        }

        .health-care-template h1 {
            font-size: 2.7rem;
            color: #ffffff;
            text-align: center;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .health-care-template h2 {
            font-size: 2rem;
            color: #1e8449;
            border-bottom: 2px solid #1e8449;
            padding-bottom: 8px;
        }

        .health-care-template h3 {
            color: #239b56;
        }

        .health-care-template li::before {
            content: 'â™¥';
            color: #e74c3c;
            font-size: 1.2rem;
        }

        .health-care-template pre, .health-care-template p code {
            background: rgba(255,255,255,0.8);
            border: 2px solid #1e8449;
            color: #1e8449;
        }

        .health-care-template table {
            background: rgba(255,255,255,0.9);
            border: 2px solid #1e8449;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .health-care-template th {
            background: #1e8449;
            color: #ffffff;
        }

        .health-care-template th, .health-care-template td {
            border-bottom: 1px solid #a8e6cf;
        }

        .health-care-template blockquote {
            border-left-color: #e74c3c;
            background: rgba(255,255,255,0.7);
        }

        .health-care-template strong {
            color: #e74c3c;
        }

        .health-care-template a {
            color: #1e8449;
        }

        .health-care-template hr {
            background: linear-gradient(90deg, transparent, #1e8449, transparent);
        }

        /* Health Medical Template */
        .health-medical-template {
            background: linear-gradient(135deg, #0f4c75 0%, #3282b8 100%);
            color: #ffffff;
            font-family: 'Inter', sans-serif;
        }

        .health-medical-template::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                repeating-linear-gradient(
                    45deg,
                    transparent,
                    transparent 20px,
                    rgba(255,255,255,0.02) 20px,
                    rgba(255,255,255,0.02) 40px
                );
            pointer-events: none;
        }

        .health-medical-template > * {
            position: relative;
            z-index: 1;
        }

        .health-medical-template h1 {
            font-size: 2.6rem;
            color: #bbe1fa;
            text-align: center;
            font-family: 'Space Grotesk', sans-serif;
        }

        .health-medical-template h2 {
            font-size: 2rem;
            color: #7fb3d3;
            border-left: 4px solid #bbe1fa;
            padding-left: 20px;
        }

        .health-medical-template h3 {
            color: #c7d2fe;
        }

        .health-medical-template li::before {
            content: '+';
            color: #bbe1fa;
            font-weight: bold;
            font-size: 1.5rem;
        }

        .health-medical-template pre, .health-medical-template p code {
            background: rgba(187, 225, 250, 0.1);
            border: 1px solid rgba(187, 225, 250, 0.3);
            color: #bbe1fa;
        }

        .health-medical-template table {
            background: rgba(187, 225, 250, 0.05);
            border: 1px solid rgba(187, 225, 250, 0.3);
        }

        .health-medical-template th {
            background: rgba(187, 225, 250, 0.2);
            color: #0f4c75;
        }

        .health-medical-template th, .health-medical-template td {
            border-bottom: 1px solid rgba(187, 225, 250, 0.2);
        }

        .health-medical-template blockquote {
            border-left-color: #bbe1fa;
            background: rgba(187, 225, 250, 0.05);
        }

        .health-medical-template strong {
            color: #bbe1fa;
        }

        .health-medical-template a {
            color: #7fb3d3;
        }

        .health-medical-template hr {
            background: linear-gradient(90deg, transparent, #bbe1fa, transparent);
        }

        /* SaaS Modern Template */
        .saas-modern-template {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #ffffff;
            font-family: 'Space Grotesk', sans-serif;
        }

        .saas-modern-template::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 25% 25%, rgba(255,255,255,0.1), transparent 50%),
                radial-gradient(circle at 75% 75%, rgba(255,255,255,0.08), transparent 50%);
            pointer-events: none;
        }

        .saas-modern-template > * {
            position: relative;
            z-index: 1;
        }

        .saas-modern-template h1 {
            font-size: 2.8rem;
            font-weight: 800;
            color: #ffffff;
            text-align: center;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .saas-modern-template h2 {
            font-size: 2rem;
            color: #ffd700;
        }

        .saas-modern-template h3 {
            color: #e8f4fd;
        }

        .saas-modern-template p {
            color: rgba(255,255,255,0.95);
        }

        .saas-modern-template li::before {
            content: 'â†’';
            color: #ffd700;
            font-weight: bold;
        }

        .saas-modern-template pre, .saas-modern-template p code {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,215,0,0.3);
            color: #ffd700;
        }

        .saas-modern-template table {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,215,0,0.3);
        }

        .saas-modern-template th {
            background: rgba(255,215,0,0.2);
            color: #ffffff;
        }

        .saas-modern-template th, .saas-modern-template td {
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .saas-modern-template blockquote {
            border-left-color: #ffd700;
            background: rgba(255,255,255,0.05);
        }

        .saas-modern-template strong {
            color: #ffd700;
        }

        .saas-modern-template a {
            color: #e8f4fd;
        }

        .saas-modern-template hr {
            background: linear-gradient(90deg, transparent, #ffd700, transparent);
        }

        /* SaaS Enterprise Template */
        .saas-enterprise-template {
            background: linear-gradient(135deg, #2c3e50 0%, #4a6741 100%);
            color: #ecf0f1;
            font-family: 'Inter', sans-serif;
        }

        .saas-enterprise-template::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                linear-gradient(45deg, transparent 40%, rgba(76, 175, 80, 0.05) 50%, transparent 60%),
                linear-gradient(-45deg, transparent 40%, rgba(76, 175, 80, 0.05) 50%, transparent 60%);
            pointer-events: none;
        }

        .saas-enterprise-template > * {
            position: relative;
            z-index: 1;
        }

        .saas-enterprise-template h1 {
            font-size: 2.6rem;
            color: #4caf50;
            text-align: center;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .saas-enterprise-template h2 {
            font-size: 2rem;
            color: #81c784;
            border-bottom: 2px solid #4caf50;
            padding-bottom: 10px;
        }

        .saas-enterprise-template h3 {
            color: #a5d6a7;
        }

        .saas-enterprise-template li::before {
            content: 'â—‰';
            color: #4caf50;
        }

        .saas-enterprise-template pre, .saas-enterprise-template p code {
            background: rgba(76, 175, 80, 0.1);
            border: 1px solid rgba(76, 175, 80, 0.3);
            color: #4caf50;
        }

        .saas-enterprise-template table {
            background: rgba(76, 175, 80, 0.05);
            border: 2px solid #4caf50;
        }

        .saas-enterprise-template th {
            background: #4caf50;
            color: #2c3e50;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .saas-enterprise-template th, .saas-enterprise-template td {
            border-bottom: 1px solid rgba(76, 175, 80, 0.2);
        }

        .saas-enterprise-template blockquote {
            border-left-color: #4caf50;
            background: rgba(76, 175, 80, 0.05);
        }

        .saas-enterprise-template strong {
            color: #4caf50;
        }

        .saas-enterprise-template a {
            color: #81c784;
        }

        .saas-enterprise-template hr {
            background: linear-gradient(90deg, transparent, #4caf50, transparent);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .template-base {
                padding: 20px;
            }
            
            .template-base h1 {
                font-size: 2rem !important;
            }
            
            .template-base h2 {
                font-size: 1.5rem !important;
            }
            
            .template-base h3 {
                font-size: 1.2rem !important;
            }
        }
    </style>
</head>
<body>
    <div class="preview-container">
        <div class="tech-neural-template template-base" id="preview">
            <h1>Professional Carousel Templates ðŸš€</h1>
            <p>Choose from 10 industry-specific templates designed for maximum impact.</p>
            <h2>Features:</h2>
            <ul>
                <li>Complete markdown syntax support</li>
                <li>Industry-specific styling</li>
                <li>Professional export options</li>
                <li>Mobile-responsive design</li>
            </ul>
        </div>
    </div>

    <script>
        let currentTemplate = 'tech-neural';

        // Configure marked options for proper markdown parsing
        marked.setOptions({
            breaks: true,
            gfm: true,
            tables: true,
            sanitize: false,
            smartLists: true,
            smartypants: true
        });

        async function downloadImage() {
            const preview = document.getElementById('preview');
            
            if (!preview.innerHTML.trim()) {
                alert('Please add some content before downloading!');
                return;
            }
            
            try {
                // Create a temporary container for the image
                const tempContainer = document.createElement('div');
                tempContainer.style.position = 'absolute';
                tempContainer.style.left = '-9999px';
                tempContainer.style.width = '800px';
                tempContainer.innerHTML = preview.outerHTML;
                document.body.appendChild(tempContainer);
                
                // Set background color based on template
                let backgroundColor = '#ffffff';
                if (currentTemplate.includes('tech-neural')) backgroundColor = '#667eea';
                else if (currentTemplate.includes('tech-quantum')) backgroundColor = '#0a0a0a';
                else if (currentTemplate.includes('product-modern')) backgroundColor = '#ff6b6b';
                else if (currentTemplate.includes('product-premium')) backgroundColor = '#2c3e50';
                else if (currentTemplate.includes('finance-gold')) backgroundColor = '#f7931e';
                else if (currentTemplate.includes('finance-elite')) backgroundColor = '#1e3c72';
                else if (currentTemplate.includes('health-care')) backgroundColor = '#56ab2f';
                else if (currentTemplate.includes('health-medical')) backgroundColor = '#0f4c75';
                else if (currentTemplate.includes('saas-modern')) backgroundColor = '#667eea';
                else if (currentTemplate.includes('saas-enterprise')) backgroundColor = '#2c3e50';

                const canvas = await html2canvas(tempContainer.firstChild, {
                    backgroundColor: backgroundColor,
                    scale: 2,
                    useCORS: true,
                    allowTaint: true,
                    width: 800,
                    height: null,
                    logging: false
                });
                
                document.body.removeChild(tempContainer);
                
                // Download the image
                const link = document.createElement('a');
                link.download = `carousel-${currentTemplate}-${Date.now()}.png`;
                link.href = canvas.toDataURL('image/png');
                link.click();
                
            } catch (error) {
                console.error('Error generating image:', error);
                alert('Error generating image. Please try again.');
            }
        }

        // async function downloadPDF() {
        //     const preview = document.getElementById('preview');
            
        //     if (!preview.innerHTML.trim()) {
        //         alert('Please add some content before downloading!');
        //         return;
        //     }
            
        //     try {
        //         // Create a temporary container for the PDF
        //         const tempContainer = document.createElement('div');
        //         tempContainer.style.position = 'absolute';
        //         tempContainer.style.left = '-9999px';
        //         tempContainer.style.width = '800px';
        //         tempContainer.innerHTML = preview.outerHTML;
        //         document.body.appendChild(tempContainer);
                
        //         // Set background color based on template
        //         let backgroundColor = '#ffffff';
        //         if (currentTemplate.includes('tech-neural')) backgroundColor = '#667eea';
        //         else if (currentTemplate.includes('tech-quantum')) backgroundColor = '#0a0a0a';
        //         else if (currentTemplate.includes('product-modern')) backgroundColor = '#ff6b6b';
        //         else if (currentTemplate.includes('product-premium')) backgroundColor = '#2c3e50';
        //         else if (currentTemplate.includes('finance-gold')) backgroundColor = '#f7931e';
        //         else if (currentTemplate.includes('finance-elite')) backgroundColor = '#1e3c72';
        //         else if (currentTemplate.includes('health-care')) backgroundColor = '#56ab2f';
        //         else if (currentTemplate.includes('health-medical')) backgroundColor = '#0f4c75';
        //         else if (currentTemplate.includes('saas-modern')) backgroundColor = '#667eea';
        //         else if (currentTemplate.includes('saas-enterprise')) backgroundColor = '#2c3e50';
                
        //         const canvas = await html2canvas(tempContainer.firstChild, {
        //             backgroundColor: backgroundColor,
        //             scale: 2,
        //             useCORS: true,
        //             allowTaint: true,
        //             width: 800,
        //             height: null,
        //             logging: false
        //         });
                
        //         document.body.removeChild(tempContainer);
                
        //         // Create PDF
        //         const { jsPDF } = window.jspdf;
        //         const pdf = new jsPDF('p', 'mm', 'a4');
                
        //         const imgData = canvas.toDataURL('image/png');
        //         const imgWidth = 210; // A4 width in mm
        //         const pageHeight = 295; // A4 height in mm
        //         const imgHeight = (canvas.height * imgWidth) / canvas.width;
        //         let heightLeft = imgHeight;
                
        //         let position = 0;
                
        //         pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
        //         heightLeft -= pageHeight;
                
        //         while (heightLeft >= 0) {
        //             position = heightLeft - imgHeight;
        //             pdf.addPage();
        //             pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
        //             heightLeft -= pageHeight;
        //         }
                
        //         pdf.save(`carousel-${currentTemplate}-${Date.now()}.pdf`);
                
        //     } catch (error) {
        //         console.error('Error generating PDF:', error);
        //         alert('Error generating PDF. Please try again.');
        //     }
        // }

        async function downloadPDF() {
    const preview = document.getElementById('preview');
    
    if (!preview.innerHTML.trim()) {
        alert('Please add some content before downloading!');
        return;
    }
    
    try {
        // LinkedIn target dimensions
        const LINKEDIN_WIDTH = 1080;
        const LINKEDIN_HEIGHT = 1350;
        
        // Create temporary container with LinkedIn dimensions
        const tempContainer = document.createElement('div');
        tempContainer.style.position = 'absolute';
        tempContainer.style.left = '-9999px';
        tempContainer.style.top = '-9999px';
        tempContainer.style.width = LINKEDIN_WIDTH + 'px';
        tempContainer.style.height = 'auto';
        tempContainer.style.minHeight = LINKEDIN_HEIGHT + 'px';
        tempContainer.style.visibility = 'hidden';
        tempContainer.style.overflow = 'visible';
        
        // Clone the preview content with deep cloning
        const previewClone = preview.cloneNode(true);
        previewClone.id = 'temp-preview-clone';
        
        // Critical: Remove all overflow constraints to prevent chopping
        previewClone.style.overflow = 'visible';
        previewClone.style.maxHeight = 'none';
        previewClone.style.height = 'auto';
        previewClone.style.minHeight = 'auto';
        previewClone.style.whiteSpace = 'normal';
        
        // Fix all nested elements to prevent content chopping
        const allElements = previewClone.querySelectorAll('*');
        allElements.forEach(element => {
            // Remove overflow constraints
            element.style.overflow = 'visible';
            element.style.maxHeight = 'none';
            element.style.textOverflow = 'clip';
            element.style.whiteSpace = 'normal';
            
            // Fix table-specific issues
            if (element.tagName === 'TABLE') {
                element.style.width = 'auto';
                element.style.minWidth = '100%';
                element.style.tableLayout = 'auto';
                element.style.wordBreak = 'break-word';
            }
            
            // Fix table cell issues
            if (element.tagName === 'TD' || element.tagName === 'TH') {
                element.style.whiteSpace = 'normal';
                element.style.wordWrap = 'break-word';
                element.style.overflow = 'visible';
            }
            
            // Fix image container issues
            if (element.tagName === 'IMG') {
                element.style.maxWidth = '100%';
                element.style.height = 'auto';
                element.style.objectFit = 'contain';
            }
            
            // Fix text container issues
            if (['P', 'DIV', 'SPAN', 'H1', 'H2', 'H3', 'H4', 'H5', 'H6'].includes(element.tagName)) {
                element.style.overflow = 'visible';
                element.style.whiteSpace = 'normal';
                element.style.wordWrap = 'break-word';
                element.style.hyphens = 'auto';
            }
        });
        
        // Calculate optimal scaling to fit LinkedIn dimensions
        const originalWidth = preview.offsetWidth;
        const originalHeight = preview.offsetHeight;
        
        // Smart scaling: fit content while maintaining aspect ratio
        const widthScale = LINKEDIN_WIDTH / originalWidth;
        const heightScale = LINKEDIN_HEIGHT / originalHeight;
        const optimalScale = Math.min(widthScale, heightScale, 1.2); // Cap at 1.2x to maintain quality
        
        // Apply scaling transformation
        previewClone.style.transform = `scale(${optimalScale})`;
        previewClone.style.transformOrigin = 'top left';
        previewClone.style.width = originalWidth + 'px';
        previewClone.style.height = originalHeight + 'px';
        
        // Append to temp container and then to body
        tempContainer.appendChild(previewClone);
        document.body.appendChild(tempContainer);
        
        // Wait for content to render and fonts to load
        await new Promise(resolve => setTimeout(resolve, 800));
        
        // Ensure all images are loaded
        const images = tempContainer.querySelectorAll('img');
        await Promise.all(Array.from(images).map(img => {
            return new Promise(resolve => {
                if (img.complete) {
                    resolve();
                } else {
                    img.onload = resolve;
                    img.onerror = resolve;
                    setTimeout(resolve, 3000); // Fallback timeout
                }
            });
        }));
        
        // Calculate final container dimensions
        const scaledWidth = LINKEDIN_WIDTH;
        const scaledHeight = Math.max(LINKEDIN_HEIGHT, originalHeight * optimalScale);
        
        tempContainer.style.width = scaledWidth + 'px';
        tempContainer.style.height = scaledHeight + 'px';
        
        // Set background color based on template with fallback
        let backgroundColor = '#ffffff';
        if (typeof currentTemplate !== 'undefined' && currentTemplate) {
            if (currentTemplate.includes('tech-neural')) backgroundColor = '#667eea';
            else if (currentTemplate.includes('tech-quantum')) backgroundColor = '#0a0a0a';
            else if (currentTemplate.includes('product-modern')) backgroundColor = '#ff6b6b';
            else if (currentTemplate.includes('product-premium')) backgroundColor = '#2c3e50';
            else if (currentTemplate.includes('finance-gold')) backgroundColor = '#f7931e';
            else if (currentTemplate.includes('finance-elite')) backgroundColor = '#1e3c72';
            else if (currentTemplate.includes('health-care')) backgroundColor = '#56ab2f';
            else if (currentTemplate.includes('health-medical')) backgroundColor = '#0f4c75';
            else if (currentTemplate.includes('saas-modern')) backgroundColor = '#667eea';
            else if (currentTemplate.includes('saas-enterprise')) backgroundColor = '#2c3e50';
        }
        
        // Generate canvas with optimized settings for quality + file size balance
        const canvas = await html2canvas(tempContainer, {
            backgroundColor: backgroundColor,
            scale: 1.5, // Optimal balance between quality and file size
            useCORS: true,
            allowTaint: true,
            width: scaledWidth,
            height: scaledHeight,
            logging: false,
            imageTimeout: 15000,
            removeContainer: false,
            foreignObjectRendering: true,
            letterRendering: true,
            // Optimization settings for smaller file size
            onclone: (clonedDoc) => {
                // Ensure cloned document maintains our fixes
                const clonedContainer = clonedDoc.querySelector('#temp-preview-clone');
                if (clonedContainer) {
                    clonedContainer.style.overflow = 'visible';
                }
            }
        });
        
        // Clean up temporary container
        document.body.removeChild(tempContainer);
        
        // Create PDF with exact LinkedIn dimensions
        const { jsPDF } = window.jspdf;
        
        // Calculate PDF dimensions to match LinkedIn aspect ratio (1080:1350 = 4:5)
        const aspectRatio = LINKEDIN_HEIGHT / LINKEDIN_WIDTH; // 1.25
        const pdfWidth = 216; // Slightly larger than A4 width for better quality
        const pdfHeight = pdfWidth * aspectRatio; // LinkedIn proportional height
        
        const pdf = new jsPDF({
            orientation: 'portrait',
            unit: 'mm',
            format: [pdfWidth, pdfHeight],
            compress: true,
            precision: 2
        });
        
        // Convert to JPEG with optimal quality/size balance
        const imgData = canvas.toDataURL('image/jpeg', 0.85); // 85% quality - sweet spot
        
        // Calculate perfect fit dimensions (no cropping, no empty space)
        const canvasAspectRatio = canvas.height / canvas.width;
        const pdfAspectRatio = pdfHeight / pdfWidth;
        
        let imgWidth, imgHeight, x, y;
        
        // Smart fitting algorithm - ensure no content is cropped
        if (Math.abs(canvasAspectRatio - pdfAspectRatio) < 0.01) {
            // Aspect ratios match - perfect fit
            imgWidth = pdfWidth;
            imgHeight = pdfHeight;
            x = 0;
            y = 0;
        } else if (canvasAspectRatio > pdfAspectRatio) {
            // Content is taller - fit to height, center horizontally
            imgHeight = pdfHeight;
            imgWidth = imgHeight / canvasAspectRatio;
            x = (pdfWidth - imgWidth) / 2;
            y = 0;
        } else {
            // Content is wider - fit to width, center vertically
            imgWidth = pdfWidth;
            imgHeight = imgWidth * canvasAspectRatio;
            x = 0;
            y = (pdfHeight - imgHeight) / 2;
        }
        
        // Add image to PDF with perfect positioning
        pdf.addImage(imgData, 'JPEG', x, y, imgWidth, imgHeight, undefined, 'FAST');
        
        // Add metadata for better organization
        pdf.setProperties({
            title: `LinkedIn Post - ${currentTemplate || 'Custom'}`,
            subject: 'LinkedIn Post Export',
            author: 'Carousel Generator',
            creator: 'Carousel Generator',
            producer: 'jsPDF'
        });
        
        // Generate filename with template and timestamp
        const templateName = (typeof currentTemplate !== 'undefined' && currentTemplate) 
            ? currentTemplate.replace(/[^a-zA-Z0-9]/g, '-') 
            : 'custom';
        const timestamp = new Date().toISOString().slice(0, 19).replace(/[:.]/g, '-');
        const filename = `linkedin-post-${templateName}-${timestamp}.pdf`;
        
        // Save the PDF
        pdf.save(filename);
        
        console.log(`âœ… LinkedIn PDF generated successfully!`);
        console.log(`ðŸ“ Dimensions: ${canvas.width}x${canvas.height}px (scaled to ${LINKEDIN_WIDTH}x${LINKEDIN_HEIGHT})`);
        console.log(`ðŸ“ File: ${filename}`);
        console.log(`ðŸŽ¨ Background: ${backgroundColor}`);
        
    } catch (error) {
        console.error('âŒ Error generating PDF:', error);
        
        // Clean up any remaining temp containers
        const tempContainers = document.querySelectorAll('[id*="temp-preview"]');
        tempContainers.forEach(container => {
            if (container.parentNode) {
                container.parentNode.removeChild(container);
            }
        });
        
        alert('Error generating PDF. Please try again. Check the console for details.');
    }
}
        const preview = document.getElementById('preview');

        window.addEventListener('message', async (event) => {
            const { action, content, template } = event.data;

            if (action === 'updateContent') {
                try {
                    // Parse markdown to HTML first
                    const htmlContent = marked.parse(content || '');
                    preview.innerHTML = htmlContent;
                    preview.className = template + '-template template-base';
                    currentTemplate = template;
                } catch (error) {
                    console.error('Error parsing markdown:', error);
                    preview.innerHTML = content || '';
                    preview.className = template + '-template template-base';
                    currentTemplate = template;
                }
            }
            else if (action === 'downloadImage') {
                await downloadImage();
            }
            else if (action === 'downloadPDF') {
                await downloadPDF();
            }
        });

        // Initialize with default content
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Carousel template loaded successfully');
        });
    </script>
</body>
</html>
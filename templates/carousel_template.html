<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carousel Templates</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/9.1.2/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600&family=Playfair+Display:wght@400;500;600;700&family=Space+Grotesk:wght@300;400;500;600;700&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600&family=Playfair+Display:wght@400;500;600;700&family=Space+Grotesk:wght@300;400;500;600;700&display=swap');
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: #f5f5f5;
            min-height: 100vh;
            padding: 0;
            margin: 0;
        }

        .preview-container {
            width: 100%;
            min-height: 100vh;
            background: white;
            overflow: hidden;
        }

.template-base {
    padding: 80px 60px;
    min-height: 100vh;
    line-height: 1.9;
    position: relative;
    font-size: 1.5rem;
}

/* üìè FONT SIZES ONLY - Let templates handle colors, backgrounds, etc. */
.template-base h1 {
    font-size: 4.5rem !important;
    font-weight: 900;
    margin: 50px 0 40px 0;
    line-height: 1.1;
    letter-spacing: -0.03em;
    /* NO color, background, or decorative styles - templates handle this */
}

.template-base h2 {
    font-size: 3.5rem !important;
    font-weight: 800;
    margin: 45px 0 35px 0;
    line-height: 1.2;
    letter-spacing: -0.02em;
    /* NO color, background, or decorative styles */
}

.template-base h3 {
    font-size: 2.8rem !important;
    font-weight: 700;
    margin: 40px 0 25px 0;
    line-height: 1.3;
    letter-spacing: -0.01em;
    /* NO color, background, or decorative styles */
}

.template-base h4 {
    font-size: 2.3rem !important;
    font-weight: 700;
    margin: 35px 0 25px 0;
    line-height: 1.4;
    /* NO color, background, or decorative styles */
}

.template-base h5 {
    font-size: 1.9rem !important;
    font-weight: 600;
    margin: 30px 0 20px 0;
    line-height: 1.5;
    /* NO color, background, or decorative styles */
}

.template-base h6 {
    font-size: 1.6rem !important;
    font-weight: 600;
    margin: 25px 0 18px 0;
    line-height: 1.5;
    /* NO color, background, or decorative styles */
}

/* üìù TEXT SIZING ONLY */
.template-base p {
    margin-bottom: 32px;
    font-size: 1.7rem !important;
    line-height: 1.8;
    font-weight: 500;
    /* NO colors - let templates handle styling */
}

/* üìã LIST SIZING ONLY */
.template-base ul, .template-base ol {
    margin: 40px 0;
    padding-left: 0;
    font-size: 1.6rem !important;
}

.template-base li {
    list-style: none;
    margin: 25px 0;
    padding-left: 60px;
    position: relative;
    font-size: 1.6rem !important;
    line-height: 1.7;
    font-weight: 500;
    /* NO bullet styling - templates handle ::before */
}

/* üíª CODE SIZING ONLY */
.template-base pre {
    border-radius: 20px;
    padding: 40px !important;
    margin: 50px 0;
    overflow-x: auto;
    font-size: 1.4rem !important;
    line-height: 1.7;
    /* NO background, border, colors - templates handle styling */
}

.template-base code {
    font-size: 1.3rem !important;
    font-weight: 600;
    /* NO background, colors - templates handle styling */
}

.template-base p code {
    padding: 8px 16px !important;
    border-radius: 10px;
    font-size: 1.2rem !important;
    font-weight: 600;
    white-space: nowrap;
    /* NO background, colors - templates handle styling */
}

/* üìä TABLE SIZING ONLY */
.template-base table {
    width: 100%;
    border-collapse: separate;
    border-spacing: 0;
    margin: 50px 0;
    border-radius: 20px;
    overflow: hidden;
    font-size: 1.4rem !important;
    /* NO background, shadows, borders - templates handle styling */
}

.template-base th, .template-base td {
    padding: 25px 30px !important;
    text-align: left;
    font-size: 1.4rem !important;
    line-height: 1.6;
    /* NO background, colors, borders - templates handle styling */
}

.template-base th {
    font-weight: 800;
    font-size: 1.5rem !important;
    text-transform: uppercase;
    letter-spacing: 1px;
    /* NO background, colors - templates handle styling */
}

/* üí¨ BLOCKQUOTE SIZING ONLY */
.template-base blockquote {
    margin: 50px 0;
    padding: 40px 50px !important;
    border-radius: 20px;
    font-style: italic;
    font-size: 1.8rem !important;
    line-height: 1.8;
    font-weight: 500;
    position: relative;
    /* NO background, border, colors - templates handle styling */
}

/* üîó LINK SIZING ONLY */
.template-base a {
    text-decoration: none;
    font-weight: 700;
    font-size: inherit;
    transition: all 0.3s ease;
    position: relative;
    /* NO colors, borders - templates handle styling */
}

/* ‚ûñ DIVIDER SIZING ONLY */
.template-base hr {
    border: none;
    height: 6px !important;
    margin: 60px 0;
    border-radius: 3px;
    /* NO background, colors - templates handle styling */
}

/* üí™ TEXT STYLING SIZING ONLY */
.template-base strong {
    font-weight: 900;
    font-size: inherit;
    /* NO colors - templates handle styling */
}

.template-base em {
    font-style: italic;
    font-size: inherit;
    font-weight: 600;
    /* NO colors - templates handle styling */
}

/* üì± RESPONSIVE SIZING */
@media (max-width: 1200px) {
    .template-base {
        padding: 60px 40px;
    }
    
    .template-base h1 {
        font-size: 3.8rem !important;
    }
    
    .template-base h2 {
        font-size: 3rem !important;
    }
    
    .template-base h3 {
        font-size: 2.4rem !important;
    }
}

@media (max-width: 768px) {
    .template-base {
        padding: 40px 30px;
    }
    
    .template-base h1 {
        font-size: 3.2rem !important;
    }
    
    .template-base h2 {
        font-size: 2.6rem !important;
    }
    
    .template-base h3 {
        font-size: 2rem !important;
    }
    
    .template-base p {
        font-size: 1.5rem !important;
    }
    
    .template-base li {
        font-size: 1.4rem !important;
    }
}

/* üéØ FALLBACK BASE STYLING - Only applies when NO template is used */
.template-base:not([class*="-template"]) {
    background: linear-gradient(135deg, #fafafa 0%, #f5f7fa 100%);
    box-shadow: inset 0 0 100px rgba(0,0,0,0.02);
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
    color: #2d3748;
}

.template-base:not([class*="-template"]) h1 {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    text-shadow: 0 2px 4px rgba(0,0,0,0.08);
}

.template-base:not([class*="-template"]) h1::after {
    content: '';
    position: absolute;
    bottom: -15px;
    left: 0;
    width: 120px;
    height: 6px;
    background: linear-gradient(90deg, #667eea, #764ba2);
    border-radius: 3px;
    box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
}

.template-base:not([class*="-template"]) h2 {
    color: #2d3748;
}

.template-base:not([class*="-template"]) h2::before {
    content: '';
    position: absolute;
    left: 0;
    bottom: 0;
    width: 80px;
    height: 4px;
    background: linear-gradient(90deg, #667eea, #764ba2);
    border-radius: 2px;
}

.template-base:not([class*="-template"]) li::before {
    content: '‚óè';
    position: absolute;
    left: 0;
    top: 0;
    color: #667eea;
    font-size: 2rem;
    font-weight: bold;
    text-shadow: 0 2px 4px rgba(102, 126, 234, 0.2);
}

.template-base:not([class*="-template"]) pre {
    background: linear-gradient(135deg, #1a202c 0%, #2d3748 100%);
    border: 3px solid #e2e8f0;
    color: #e2e8f0;
    box-shadow: 0 15px 40px rgba(0,0,0,0.15);
}

.template-base:not([class*="-template"]) p code {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    box-shadow: 0 4px 15px rgba(102, 126, 234, 0.2);
}

.template-base:not([class*="-template"]) table {
    background: white;
    box-shadow: 0 20px 50px rgba(0,0,0,0.15);
}

.template-base:not([class*="-template"]) th {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    text-shadow: 0 1px 2px rgba(0,0,0,0.1);
}

.template-base:not([class*="-template"]) blockquote {
    border-left: 8px solid #667eea;
    background: linear-gradient(135deg, #f7fafc 0%, #edf2f7 100%);
    color: #2d3748;
    box-shadow: 0 10px 30px rgba(102, 126, 234, 0.1);
}

.template-base:not([class*="-template"]) a {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.template-base:not([class*="-template"]) hr {
    background: linear-gradient(90deg, transparent, #667eea, #764ba2, transparent);
    box-shadow: 0 4px 15px rgba(102, 126, 234, 0.2);
}

.template-base:not([class*="-template"]) strong {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.template-base:not([class*="-template"]) em {
    color: #667eea;
}
        /* Tech Neural Template */
        .tech-neural-template {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-family: 'Space Grotesk', sans-serif;
        }

        .tech-neural-template::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 50%, rgba(255,255,255,0.1), transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255,255,255,0.08), transparent 50%);
            pointer-events: none;
        }

        .tech-neural-template > * {
            position: relative;
            z-index: 1;
        }

        .tech-neural-template h1 {
            font-size: 2.4rem;
            color: #ffffff;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .tech-neural-template h2 {
            font-size: 1.8rem;
            color: #e8f4fd;
            border-bottom: 2px solid rgba(255,255,255,0.3);
            padding-bottom: 8px;
        }

        .tech-neural-template h3 {
            font-size: 1.4rem;
            color: #d1ecf1;
        }

        .tech-neural-template li::before {
            content: '‚ñ∂';
            position: absolute;
            left: 0;
            color: #ffd700;
        }

        .tech-neural-template pre, .tech-neural-template p code {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            color: #e8f4fd;
        }

        .tech-neural-template table {
            background: rgba(255,255,255,0.1);
        }

        .tech-neural-template th {
            background: rgba(255,255,255,0.2);
            color: #ffffff;
        }

        .tech-neural-template th, .tech-neural-template td {
            border-bottom: 1px solid rgba(255,255,255,0.2);
        }

        .tech-neural-template blockquote {
            border-left-color: #ffd700;
            background: rgba(255,255,255,0.05);
        }

        .tech-neural-template strong {
            color: #ffd700;
        }

        .tech-neural-template a {
            color: #ffd700;
        }

        .tech-neural-template hr {
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
        }

        .tech-neural-template mark {
                padding: 3px 6px;
                border-radius: 6px;
                font-weight: 600;
                background: currentColor;
                color: var(--bg-color, white);
                opacity: 0.8;
                mix-blend-mode: multiply;
                box-shadow: 0 0 8px currentColor;
                transition: all 0.2s ease;
            }

        /* Tech Quantum Template */
        .tech-quantum-template {
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #16213e 100%);
            color: #00d4ff;
            font-family: 'JetBrains Mono', monospace;
        }

        .tech-quantum-template::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                repeating-linear-gradient(
                    90deg,
                    transparent,
                    transparent 100px,
                    rgba(0, 212, 255, 0.05) 100px,
                    rgba(0, 212, 255, 0.05) 101px
                );
            pointer-events: none;
        }

        .tech-quantum-template > * {
            position: relative;
            z-index: 1;
        }

        .tech-quantum-template h1 {
            font-size: 2.6rem;
            color: #00d4ff;
            text-shadow: 0 0 20px rgba(0, 212, 255, 0.5);
            font-family: 'Space Grotesk', sans-serif;
        }

        .tech-quantum-template h2 {
            font-size: 1.9rem;
            color: #ff006e;
            text-shadow: 0 0 15px rgba(255, 0, 110, 0.4);
        }

        .tech-quantum-template h3 {
            color: #8338ec;
        }

        .tech-quantum-template p {
            color: #b8c6db;
        }

        .tech-quantum-template li::before {
            content: '>';
            color: #00d4ff;
            font-weight: bold;
        }

        .tech-quantum-template pre, .tech-quantum-template p code {
            background: rgba(0, 212, 255, 0.1);
            border: 1px solid rgba(0, 212, 255, 0.3);
            color: #00d4ff;
        }

        .tech-quantum-template table {
            background: rgba(0, 212, 255, 0.05);
            border: 1px solid rgba(0, 212, 255, 0.2);
        }

        .tech-quantum-template th {
            background: rgba(0, 212, 255, 0.2);
            color: #ffffff;
        }

        .tech-quantum-template th, .tech-quantum-template td {
            border: 1px solid rgba(0, 212, 255, 0.2);
        }

        .tech-quantum-template blockquote {
            border-left-color: #ff006e;
            background: rgba(255, 0, 110, 0.05);
        }

        .tech-quantum-template strong {
            color: #ff006e;
        }

        .tech-quantum-template a {
            color: #8338ec;
        }

        .tech-quantum-template hr {
            background: linear-gradient(90deg, transparent, #00d4ff, transparent);
        }

        .tech-quantum-template mark {
                padding: 3px 6px;
                border-radius: 6px;
                font-weight: 600;
                background: currentColor;
                color: var(--bg-color, white);
                opacity: 0.8;
                mix-blend-mode: multiply;
                box-shadow: 0 0 8px currentColor;
                transition: all 0.2s ease;
            }

        /* Product Modern Template */
        .product-modern-template {
            background: linear-gradient(135deg, #ff6b6b 0%, #feca57 100%);
            color: #2c3e50;
            font-family: 'Inter', sans-serif;
        }

        .product-modern-template::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 80% 20%, rgba(255,255,255,0.2), transparent 50%),
                radial-gradient(circle at 20% 80%, rgba(255,255,255,0.1), transparent 50%);
            pointer-events: none;
        }

        .product-modern-template > * {
            position: relative;
            z-index: 1;
        }

        .product-modern-template h1 {
            font-size: 2.8rem;
            font-weight: 800;
            color: #ffffff;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .product-modern-template h2 {
            font-size: 2rem;
            font-weight: 700;
            color: #2c3e50;
        }

        .product-modern-template h3 {
            color: #34495e;
        }

        .product-modern-template li::before {
            content: '‚úì';
            color: #27ae60;
            font-weight: bold;
            font-size: 1.2rem;
        }

        .product-modern-template pre, .product-modern-template p code {
            background: rgba(255,255,255,0.8);
            border: 1px solid rgba(44, 62, 80, 0.2);
            color: #2c3e50;
        }

        .product-modern-template table {
            background: rgba(255,255,255,0.9);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .product-modern-template th {
            background: rgba(44, 62, 80, 0.8);
            color: #ffffff;
        }

        .product-modern-template th, .product-modern-template td {
            border-bottom: 1px solid rgba(44, 62, 80, 0.1);
        }

        .product-modern-template blockquote {
            border-left-color: #27ae60;
            background: rgba(255,255,255,0.6);
        }

        .product-modern-template strong {
            color: #e74c3c;
        }

        .product-modern-template a {
            color: #3498db;
        }

        .product-modern-template hr {
            background: linear-gradient(90deg, transparent, rgba(44, 62, 80, 0.3), transparent);
        }

        .product-modern-template mark {
                padding: 3px 6px;
                border-radius: 6px;
                font-weight: 600;
                background: currentColor;
                color: var(--bg-color, white);
                opacity: 0.8;
                mix-blend-mode: multiply;
                box-shadow: 0 0 8px currentColor;
                transition: all 0.2s ease;
            }
        /* Product Premium Template */
        .product-premium-template {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: #ecf0f1;
            font-family: 'Playfair Display', serif;
        }

        .product-premium-template::before {
            content: '';
            position: absolute;
            top: 20px;
            left: 20px;
            right: 20px;
            bottom: 20px;
            border: 2px solid rgba(236, 240, 241, 0.2);
            border-radius: 15px;
            pointer-events: none;
        }

        .product-premium-template > * {
            position: relative;
            z-index: 1;
        }

        .product-premium-template h1 {
            font-size: 3rem;
            font-weight: 700;
            color: #f1c40f;
            text-align: center;
            font-family: 'Playfair Display', serif;
        }

        .product-premium-template h2 {
            font-size: 2.2rem;
            color: #e67e22;
            font-family: 'Playfair Display', serif;
        }

        .product-premium-template h3 {
            color: #95a5a6;
        }

        .product-premium-template p {
            font-family: 'Inter', sans-serif;
        }

        .product-premium-template li {
            font-family: 'Inter', sans-serif;
        }

        .product-premium-template li::before {
            content: '‚óÜ';
            color: #f1c40f;
        }

        .product-premium-template pre, .product-premium-template p code {
            background: rgba(236, 240, 241, 0.1);
            border: 1px solid rgba(241, 196, 15, 0.3);
            color: #f1c40f;
        }

        .product-premium-template table {
            background: rgba(236, 240, 241, 0.05);
        }

        .product-premium-template th {
            background: rgba(241, 196, 15, 0.2);
            color: #2c3e50;
            font-family: 'Inter', sans-serif;
        }

        .product-premium-template th, .product-premium-template td {
            border-bottom: 1px solid rgba(241, 196, 15, 0.2);
            font-family: 'Inter', sans-serif;
        }

        .product-premium-template blockquote {
            border-left-color: #e67e22;
            background: rgba(236, 240, 241, 0.05);
            font-family: 'Playfair Display', serif;
        }

        .product-premium-template strong {
            color: #f1c40f;
        }

        .product-premium-template a {
            color: #e67e22;
        }

        .product-premium-template hr {
            background: linear-gradient(90deg, transparent, #f1c40f, transparent);
        }

        .product-premium-template mark {
                padding: 3px 6px;
                border-radius: 6px;
                font-weight: 600;
                background: currentColor;
                color: var(--bg-color, white);
                opacity: 0.8;
                mix-blend-mode: multiply;
                box-shadow: 0 0 8px currentColor;
                transition: all 0.2s ease;
            }

        /* Finance Gold Template */
        .finance-gold-template {
            background: linear-gradient(135deg, #f7931e 0%, #ffd700 100%);
            color: #2c3e50;
            font-family: 'Space Grotesk', sans-serif;
        }

        .finance-gold-template::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 10% 20%, rgba(255,255,255,0.3), transparent 40%),
                radial-gradient(circle at 90% 80%, rgba(255,255,255,0.2), transparent 40%);
            pointer-events: none;
        }

        .finance-gold-template > * {
            position: relative;
            z-index: 1;
        }

        .finance-gold-template h1 {
            font-size: 2.8rem;
            font-weight: 800;
            color: #1a1a1a;
            text-align: center;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .finance-gold-template h2 {
            font-size: 2rem;
            color: #8b4513;
            border-bottom: 3px solid #8b4513;
            padding-bottom: 8px;
        }

        .finance-gold-template h3 {
            color: #2c3e50;
        }

        .finance-gold-template p {
            font-weight: 500;
        }

        .finance-gold-template li::before {
            content: '$';
            color: #8b4513;
            font-weight: bold;
            font-size: 1.2rem;
        }

        .finance-gold-template pre, .finance-gold-template p code {
            background: rgba(0,0,0,0.1);
            border: 2px solid #8b4513;
            color: #2c3e50;
            font-weight: 600;
        }

        .finance-gold-template table {
            background: rgba(0,0,0,0.05);
            border: 2px solid #8b4513;
        }

        .finance-gold-template th {
            background: #8b4513;
            color: #ffd700;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .finance-gold-template th, .finance-gold-template td {
            border-bottom: 1px solid #8b4513;
            font-weight: 500;
        }

        .finance-gold-template blockquote {
            border-left-color: #8b4513;
            background: rgba(0,0,0,0.05);
            font-weight: 600;
        }

        .finance-gold-template strong {
            color: #8b4513;
            font-weight: 800;
        }

        .finance-gold-template a {
            color: #8b4513;
        }

        .finance-gold-template hr {
            background: linear-gradient(90deg, transparent, #8b4513, transparent);
        }

        .finance-gold-template mark {
                padding: 3px 6px;
                border-radius: 6px;
                font-weight: 600;
                background: currentColor;
                color: var(--bg-color, white);
                opacity: 0.8;
                mix-blend-mode: multiply;
                box-shadow: 0 0 8px currentColor;
                transition: all 0.2s ease;
            }
        /* Finance Elite Template */
        .finance-elite-template {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: #ffffff;
            font-family: 'Inter', sans-serif;
        }

        .finance-elite-template::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #ffd700, #ffffff, #ffd700);
        }

        .finance-elite-template::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #ffd700, #ffffff, #ffd700);
        }

        .finance-elite-template > * {
            position: relative;
            z-index: 1;
        }

        .finance-elite-template h1 {
            font-size: 2.6rem;
            color: #ffd700;
            text-align: center;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .finance-elite-template h2 {
            font-size: 2rem;
            color: #e8f4fd;
            border-left: 4px solid #ffd700;
            padding-left: 20px;
        }

        .finance-elite-template h3 {
            color: #b8dbd9;
        }

        .finance-elite-template li::before {
            content: '‚ñ†';
            color: #ffd700;
        }

        .finance-elite-template pre, .finance-elite-template p code {
            background: rgba(255, 215, 0, 0.1);
            border: 1px solid rgba(255, 215, 0, 0.3);
            color: #ffd700;
        }

        .finance-elite-template table {
            background: rgba(255, 215, 0, 0.05);
            border: 2px solid #ffd700;
        }

        .finance-elite-template th {
            background: #ffd700;
            color: #1e3c72;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .finance-elite-template th, .finance-elite-template td {
            border-bottom: 1px solid rgba(255, 215, 0, 0.3);
        }

        .finance-elite-template blockquote {
            border-left-color: #ffd700;
            background: rgba(255, 215, 0, 0.05);
            font-size: 1.1rem;
        }

        .finance-elite-template strong {
            color: #ffd700;
        }

        .finance-elite-template a {
            color: #e8f4fd;
        }

        .finance-elite-template hr {
            background: linear-gradient(90deg, transparent, #ffd700, transparent);
        }

        .finance-elite-template mark {
                padding: 3px 6px;
                border-radius: 6px;
                font-weight: 600;
                background: currentColor;
                color: var(--bg-color, white);
                opacity: 0.8;
                mix-blend-mode: multiply;
                box-shadow: 0 0 8px currentColor;
                transition: all 0.2s ease;
            }
        /* Health Care Template */
        .health-care-template {
            background: linear-gradient(135deg, #56ab2f 0%, #a8e6cf 100%);
            color: #2c3e50;
            font-family: 'Inter', sans-serif;
        }

        .health-care-template::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 30% 30%, rgba(255,255,255,0.2), transparent 40%),
                radial-gradient(circle at 70% 70%, rgba(255,255,255,0.15), transparent 40%);
            pointer-events: none;
        }

        .health-care-template > * {
            position: relative;
            z-index: 1;
        }

        .health-care-template h1 {
            font-size: 2.7rem;
            color: #ffffff;
            text-align: center;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .health-care-template h2 {
            font-size: 2rem;
            color: #1e8449;
            border-bottom: 2px solid #1e8449;
            padding-bottom: 8px;
        }

        .health-care-template h3 {
            color: #239b56;
        }

        .health-care-template li::before {
            content: '‚ô•';
            color: #e74c3c;
            font-size: 1.2rem;
        }

        .health-care-template pre, .health-care-template p code {
            background: rgba(255,255,255,0.8);
            border: 2px solid #1e8449;
            color: #1e8449;
        }

        .health-care-template table {
            background: rgba(255,255,255,0.9);
            border: 2px solid #1e8449;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .health-care-template th {
            background: #1e8449;
            color: #ffffff;
        }

        .health-care-template th, .health-care-template td {
            border-bottom: 1px solid #a8e6cf;
        }

        .health-care-template blockquote {
            border-left-color: #e74c3c;
            background: rgba(255,255,255,0.7);
        }

        .health-care-template strong {
            color: #e74c3c;
        }

        .health-care-template a {
            color: #1e8449;
        }

        .health-care-template hr {
            background: linear-gradient(90deg, transparent, #1e8449, transparent);
        }

        .health-care-template mark {
                padding: 3px 6px;
                border-radius: 6px;
                font-weight: 600;
                background: currentColor;
                color: var(--bg-color, white);
                opacity: 0.8;
                mix-blend-mode: multiply;
                box-shadow: 0 0 8px currentColor;
                transition: all 0.2s ease;
            }

        /* Health Medical Template */
        .health-medical-template {
            background: linear-gradient(135deg, #0f4c75 0%, #3282b8 100%);
            color: #ffffff;
            font-family: 'Inter', sans-serif;
        }

        .health-medical-template::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                repeating-linear-gradient(
                    45deg,
                    transparent,
                    transparent 20px,
                    rgba(255,255,255,0.02) 20px,
                    rgba(255,255,255,0.02) 40px
                );
            pointer-events: none;
        }

        .health-medical-template > * {
            position: relative;
            z-index: 1;
        }

        .health-medical-template h1 {
            font-size: 2.6rem;
            color: #bbe1fa;
            text-align: center;
            font-family: 'Space Grotesk', sans-serif;
        }

        .health-medical-template h2 {
            font-size: 2rem;
            color: #7fb3d3;
            border-left: 4px solid #bbe1fa;
            padding-left: 20px;
        }

        .health-medical-template h3 {
            color: #c7d2fe;
        }

        .health-medical-template li::before {
            content: '+';
            color: #bbe1fa;
            font-weight: bold;
            font-size: 1.5rem;
        }

        .health-medical-template pre, .health-medical-template p code {
            background: rgba(187, 225, 250, 0.1);
            border: 1px solid rgba(187, 225, 250, 0.3);
            color: #bbe1fa;
        }

        .health-medical-template table {
            background: rgba(187, 225, 250, 0.05);
            border: 1px solid rgba(187, 225, 250, 0.3);
        }

        .health-medical-template th {
            background: rgba(187, 225, 250, 0.2);
            color: #0f4c75;
        }

        .health-medical-template th, .health-medical-template td {
            border-bottom: 1px solid rgba(187, 225, 250, 0.2);
        }

        .health-medical-template blockquote {
            border-left-color: #bbe1fa;
            background: rgba(187, 225, 250, 0.05);
        }

        .health-medical-template strong {
            color: #bbe1fa;
        }

        .health-medical-template a {
            color: #7fb3d3;
        }

        .health-medical-template hr {
            background: linear-gradient(90deg, transparent, #bbe1fa, transparent);
        }

        .health-medical-template mark {
                padding: 3px 6px;
                border-radius: 6px;
                font-weight: 600;
                background: currentColor;
                color: var(--bg-color, white);
                opacity: 0.8;
                mix-blend-mode: multiply;
                box-shadow: 0 0 8px currentColor;
                transition: all 0.2s ease;
            }
        /* SaaS Modern Template */
        .saas-modern-template {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #ffffff;
            font-family: 'Space Grotesk', sans-serif;
        }

        .saas-modern-template::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 25% 25%, rgba(255,255,255,0.1), transparent 50%),
                radial-gradient(circle at 75% 75%, rgba(255,255,255,0.08), transparent 50%);
            pointer-events: none;
        }

        .saas-modern-template > * {
            position: relative;
            z-index: 1;
        }

        .saas-modern-template h1 {
            font-size: 2.8rem;
            font-weight: 800;
            color: #ffffff;
            text-align: center;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .saas-modern-template h2 {
            font-size: 2rem;
            color: #ffd700;
        }

        .saas-modern-template h3 {
            color: #e8f4fd;
        }

        .saas-modern-template p {
            color: rgba(255,255,255,0.95);
        }

        .saas-modern-template li::before {
            content: '‚Üí';
            color: #ffd700;
            font-weight: bold;
        }

        .saas-modern-template pre, .saas-modern-template p code {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,215,0,0.3);
            color: #ffd700;
        }

        .saas-modern-template table {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,215,0,0.3);
        }

        .saas-modern-template th {
            background: rgba(255,215,0,0.2);
            color: #ffffff;
        }

        .saas-modern-template th, .saas-modern-template td {
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .saas-modern-template blockquote {
            border-left-color: #ffd700;
            background: rgba(255,255,255,0.05);
        }

        .saas-modern-template strong {
            color: #ffd700;
        }

        .saas-modern-template a {
            color: #e8f4fd;
        }

        .saas-modern-template hr {
            background: linear-gradient(90deg, transparent, #ffd700, transparent);
        }

        .saas-modern-template mark {
                padding: 3px 6px;
                border-radius: 6px;
                font-weight: 600;
                background: currentColor;
                color: var(--bg-color, white);
                opacity: 0.8;
                mix-blend-mode: multiply;
                box-shadow: 0 0 8px currentColor;
                transition: all 0.2s ease;
            }
        /* SaaS Enterprise Template */
        .saas-enterprise-template {
            background: linear-gradient(135deg, #2c3e50 0%, #4a6741 100%);
            color: #ecf0f1;
            font-family: 'Inter', sans-serif;
        }

        .saas-enterprise-template::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                linear-gradient(45deg, transparent 40%, rgba(76, 175, 80, 0.05) 50%, transparent 60%),
                linear-gradient(-45deg, transparent 40%, rgba(76, 175, 80, 0.05) 50%, transparent 60%);
            pointer-events: none;
        }

        .saas-enterprise-template > * {
            position: relative;
            z-index: 1;
        }

        .saas-enterprise-template h1 {
            font-size: 2.6rem;
            color: #4caf50;
            text-align: center;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .saas-enterprise-template h2 {
            font-size: 2rem;
            color: #81c784;
            border-bottom: 2px solid #4caf50;
            padding-bottom: 10px;
        }

        .saas-enterprise-template h3 {
            color: #a5d6a7;
        }

        .saas-enterprise-template li::before {
            content: '‚óâ';
            color: #4caf50;
        }

        .saas-enterprise-template pre, .saas-enterprise-template p code {
            background: rgba(76, 175, 80, 0.1);
            border: 1px solid rgba(76, 175, 80, 0.3);
            color: #4caf50;
        }

        .saas-enterprise-template table {
            background: rgba(76, 175, 80, 0.05);
            border: 2px solid #4caf50;
        }

        .saas-enterprise-template th {
            background: #4caf50;
            color: #2c3e50;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .saas-enterprise-template th, .saas-enterprise-template td {
            border-bottom: 1px solid rgba(76, 175, 80, 0.2);
        }

        .saas-enterprise-template blockquote {
            border-left-color: #4caf50;
            background: rgba(76, 175, 80, 0.05);
        }

        .saas-enterprise-template strong {
            color: #4caf50;
        }

        .saas-enterprise-template a {
            color: #81c784;
        }

        .saas-enterprise-template hr {
            background: linear-gradient(90deg, transparent, #4caf50, transparent);
        }

        .saas-enterprise-template mark {
                padding: 3px 6px;
                border-radius: 6px;
                font-weight: 600;
                background: currentColor;
                color: var(--bg-color, white);
                opacity: 0.8;
                mix-blend-mode: multiply;
                box-shadow: 0 0 8px currentColor;
                transition: all 0.2s ease;
            }
        /* Dark Neon Template */
.dark-neon-template {
    background: linear-gradient(135deg, #0f0f23 0%, #1a1a2e 50%, #16213e 100%);
    color: #ffffff;
    font-family: 'Space Grotesk', sans-serif;
}

.dark-neon-template::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: radial-gradient(circle at 20% 50%, rgba(120, 119, 198, 0.3), transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255, 119, 198, 0.3), transparent 50%);
    pointer-events: none;
}

.dark-neon-template > * {
    position: relative;
    z-index: 1;
}

.dark-neon-template h1 {
    font-size: 2.5rem;
    font-weight: 800;
    color: #ff006e; /* Primary gradient color */
    text-shadow: 0 0 20px rgba(255, 0, 110, 0.5);
}

.dark-neon-template h2 {
    font-size: 2rem;
    font-weight: 700;
    color: #ff006e;
    text-shadow: 0 0 20px rgba(255, 0, 110, 0.3);
}

.dark-neon-template h3 {
    font-size: 1.5rem;
    font-weight: 600;
    color: #8338ec;
    text-shadow: 0 0 15px rgba(131, 56, 236, 0.3);
}

.dark-neon-template li::before {
    content: '‚ñ∂';
    color: #ff006e;
    font-size: 0.8rem;
    text-shadow: 0 0 10px rgba(255, 0, 110, 0.5);
}

.dark-neon-template pre, .dark-neon-template p code {
    background: rgba(255, 0, 110, 0.1);
    border: 1px solid rgba(255, 0, 110, 0.3);
    color: #3a86ff;
    box-shadow: 0 0 20px rgba(255, 0, 110, 0.1);
}

.dark-neon-template table {
    background: rgba(131, 56, 236, 0.1);
    box-shadow: 0 0 20px rgba(131, 56, 236, 0.2);
}

.dark-neon-template th {
    background: rgba(255, 0, 110, 0.2);
    color: #ffffff;
    text-shadow: 0 0 10px rgba(255, 0, 110, 0.3);
}

.dark-neon-template th, .dark-neon-template td {
    border-bottom: 1px solid rgba(255, 0, 110, 0.2);
}

.dark-neon-template blockquote {
    border-left-color: #ff006e;
    background: rgba(255, 0, 110, 0.05);
    box-shadow: 0 0 15px rgba(255, 0, 110, 0.1);
}

.dark-neon-template strong {
    color: #3a86ff;
    text-shadow: 0 0 10px rgba(58, 134, 255, 0.3);
}

.dark-neon-template a {
    color: #8338ec;
    text-shadow: 0 0 8px rgba(131, 56, 236, 0.3);
}

.dark-neon-template hr {
    background: linear-gradient(90deg, transparent, #ff006e, transparent);
    box-shadow: 0 0 20px rgba(255, 0, 110, 0.3);
}

.dark-neon-template p, 
.dark-neon-template li, 
.dark-neon-template div, 
.dark-neon-template span {
    font-family: 'Inter', sans-serif !important;
}

.dark-neon-template code {
    font-family: 'Courier New', monospace !important;
}

.dark-neon-template mark {
                padding: 3px 6px;
                border-radius: 6px;
                font-weight: 600;
                background: currentColor;
                color: var(--bg-color, white);
                opacity: 0.8;
                mix-blend-mode: multiply;
                box-shadow: 0 0 8px currentColor;
                transition: all 0.2s ease;
            }

/* Sketchy Minimal Template */
.sketchy-minimal-template {
    background: #fefefe;
    color: #2d3436;
    font-family: 'Kalam', sans-serif;
    line-height: 1.8;
    position: relative;
}

.sketchy-minimal-template::before {
    content: '';
    position: absolute;
    top: 10px;
    left: 10px;
    right: 10px;
    bottom: 10px;
    border: 3px solid #2d3436;
    border-radius: 25px;
    opacity: 0.1;
    transform: rotate(-1deg);
}

.sketchy-minimal-template::after {
    content: '';
    position: absolute;
    top: 15px;
    left: 15px;
    right: 15px;
    bottom: 15px;
    border: 2px solid #636e72;
    border-radius: 20px;
    opacity: 0.05;
    transform: rotate(1deg);
}

.sketchy-minimal-template > * {
    position: relative;
    z-index: 1;
}

.sketchy-minimal-template h1 {
    font-size: 2.2rem;
    font-weight: 700;
    color: #2d3436;
    text-decoration: underline;
    text-decoration-style: wavy;
    text-underline-offset: 8px;
    transform: rotate(-1deg);
    animation: sketch 4s ease-in-out infinite;
}

.sketchy-minimal-template h2 {
    font-size: 1.8rem;
    font-weight: 700;
    color: #636e72;
    transform: rotate(0.5deg);
    border-bottom: 2px dashed #ddd;
    padding-bottom: 8px;
}

.sketchy-minimal-template h3 {
    font-size: 1.4rem;
    font-weight: 400;
    color: #2d3436;
    transform: rotate(-0.3deg);
}

.sketchy-minimal-template li::before {
    content: '‚úì';
    color: #00b894;
    font-size: 1.2rem;
    font-weight: bold;
    transform: rotate(-10deg);
}

.sketchy-minimal-template pre, .sketchy-minimal-template p code {
    background: #f8f9fc;
    border: 2px dashed #ddd;
    border-radius: 15px;
    color: #2d3436;
    transform: rotate(0.5deg);
    box-shadow: 3px 3px 0px rgba(0,0,0,0.1);
}

.sketchy-minimal-template table {
    background: #ffffff;
    border: 2px dashed #636e72;
    border-radius: 15px;
    transform: rotate(-0.5deg);
    box-shadow: 3px 3px 0px rgba(0,0,0,0.1);
}

.sketchy-minimal-template th {
    background: #f8f9fc;
    color: #2d3436;
    border-bottom: 2px dashed #ddd;
    font-weight: 700;
    transform: rotate(0.3deg);
}

.sketchy-minimal-template th, .sketchy-minimal-template td {
    border-bottom: 1px dashed #ddd;
    font-family: 'JetBrains Mono', monospace;
}

.sketchy-minimal-template blockquote {
    border-left: 4px dashed #00b894;
    background: #f8f9fc;
    transform: rotate(0.5deg);
    box-shadow: 2px 2px 0px rgba(0,0,0,0.05);
}

.sketchy-minimal-template strong {
    color: #00b894;
    font-weight: 700;
}

.sketchy-minimal-template a {
    color: #636e72;
    text-decoration: underline;
    text-decoration-style: wavy;
}

.sketchy-minimal-template hr {
    border: none;
    height: 2px;
    background: repeating-linear-gradient(90deg, #ddd, #ddd 10px, transparent 10px, transparent 20px);
    margin: 30px 0;
}
@keyframes sketch {
    0%, 100% { transform: rotate(-0.5deg); }
    25% { transform: rotate(0.5deg); }
    75% { transform: rotate(-0.3deg); }
}
.sketchy-minimal-template h1,
.sketchy-minimal-template h2,
.sketchy-minimal-template h3,
.sketchy-minimal-template h4,
.sketchy-minimal-template h5,
.sketchy-minimal-template h6,
.sketchy-minimal-template p, 
.sketchy-minimal-template li, 
.sketchy-minimal-template div, 
.sketchy-minimal-template span,
.sketchy-minimal-template blockquote {
font-family:'Kalam', sans-serif !important;
}

.sketchy-minimal-template code {
    font-family: 'Courier New', monospace !important;
}

.sketchy-minimal-template mark {
                padding: 3px 6px;
                border-radius: 6px;
                font-weight: 600;
                background: currentColor;
                color: var(--bg-color, white);
                opacity: 0.8;
                mix-blend-mode: multiply;
                box-shadow: 0 0 8px currentColor;
                transition: all 0.2s ease;
            }
/* Executive Board Template */
.executive-board-template {
    background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
    color: #212529;
    font-family: 'Inter', sans-serif;
    border-left: 6px solid #1e3c72;
}

.executive-board-template::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: linear-gradient(90deg, #1e3c72, #2a5298, #1e3c72);
}

.executive-board-template h1 {
    font-size: 2.8rem;
    font-weight: 700;
    color: #1e3c72;
    text-align: center;
    position: relative;
    padding-bottom: 20px;
}

.executive-board-template h1::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 50%;
    transform: translateX(-50%);
    width: 100px;
    height: 3px;
    background: linear-gradient(90deg, #1e3c72, #2a5298);
    border-radius: 2px;
}

.executive-board-template h2 {
    font-size: 2rem;
    font-weight: 600;
    color: #2a5298;
    border-bottom: 2px solid #dee2e6;
    padding-bottom: 10px;
    position: relative;
}

.executive-board-template h2::before {
    content: '';
    position: absolute;
    left: 0;
    bottom: -2px;
    width: 50px;
    height: 2px;
    background: #1e3c72;
}

.executive-board-template li::before {
    content: '‚ñ™';
    color: #1e3c72;
    font-size: 1.5rem;
    font-weight: bold;
    top: -2px;
}

.executive-board-template pre, .executive-board-template p code {
    background: #ffffff;
    border: 1px solid #dee2e6;
    color: #495057;
    box-shadow: 0 2px 10px rgba(0,0,0,0.08);
    border-left: 4px solid #1e3c72;
}

.executive-board-template table {
    background: #ffffff;
    border: 1px solid #dee2e6;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    border-radius: 8px;
    overflow: hidden;
}

.executive-board-template th {
    background: linear-gradient(135deg, #1e3c72, #2a5298);
    color: #ffffff;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.executive-board-template th, .executive-board-template td {
    border-bottom: 1px solid #dee2e6;
    font-family: 'Inter', sans-serif;
    padding: 15px;
}

.executive-board-template td {
    background: #ffffff;
}

.executive-board-template blockquote {
    border-left: 4px solid #1e3c72;
    background: #f8f9fa;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.05);
}

.executive-board-template strong {
    color: #1e3c72;
    font-weight: 700;
}

.executive-board-template a {
    color: #2a5298;
    font-weight: 600;
}

.executive-board-template hr {
    background: linear-gradient(90deg, transparent, #1e3c72, transparent);
    height: 2px;
    border: none;
    margin: 30px 0;
}
.executive-board-template h3,
.executive-board-template h4,
.executive-board-template h5,
.executive-board-template h6,
.executive-board-template p, 
.executive-board-template li, 
.executive-board-template div, 
.executive-board-template span {
    font-family: 'Inter', sans-serif !important;
}

.executive-board-template code {
    font-family: 'Courier New', monospace !important;
}

.executive-board-template  mark {
                padding: 3px 6px;
                border-radius: 6px;
                font-weight: 600;
                background: currentColor;
                color: var(--bg-color, white);
                opacity: 0.8;
                mix-blend-mode: multiply;
                box-shadow: 0 0 8px currentColor;
                transition: all 0.2s ease;
            }
/* Gradient Pro Template */
.gradient-pro-template {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
    color: white;
    font-family: 'Space Grotesk', sans-serif;
}

.gradient-pro-template::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(45deg, rgba(255,255,255,0.1) 0%, transparent 50%, rgba(255,255,255,0.1) 100%);
    opacity: 0.5;
}


.gradient-pro-template > * {
    position: relative;
    z-index: 1;
}

.gradient-pro-template h1 {
    font-size: 2.6rem;
    font-weight: 800;
    color: #ffffff;
    text-align: center;
    text-shadow: 0 2px 4px rgba(0,0,0,0.3);
}

.gradient-pro-template h2 {
    font-size: 2rem;
    font-weight: 700;
    color: #ffd89b;
}

.gradient-pro-template li::before {
    content: '‚ú®';
    font-size: 1.2rem;
}

.gradient-pro-template pre, .gradient-pro-template p code {
    background: rgba(255,255,255,0.15);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255,255,255,0.3);
    color: #f8f9fa;
}

.gradient-pro-template table {
    background: rgba(255,255,255,0.1);
    backdrop-filter: blur(15px);
    border: 1px solid rgba(255,255,255,0.3);
    border-radius: 15px;
    overflow: hidden;
    box-shadow: 0 8px 32px rgba(0,0,0,0.2);
}

.gradient-pro-template th {
    background: linear-gradient(135deg, rgba(255,255,255,0.3), rgba(255,255,255,0.1));
    color: #ffffff;
    font-weight: 700;
    backdrop-filter: blur(10px);
}

.gradient-pro-template th, .gradient-pro-template td {
    border-bottom: 1px solid rgba(255,255,255,0.2);
    font-family: 'Space Grotesk', sans-serif;
}

.gradient-pro-template td {
    color: rgba(255,255,255,0.95);
}

.gradient-pro-template blockquote {
    border-left: 4px solid rgba(255,255,255,0.8);
    background: rgba(255,255,255,0.1);
    backdrop-filter: blur(10px);
    border-radius: 10px;
}

.gradient-pro-template strong {
    color: #ffd89b;
    font-weight: 800;
}

.gradient-pro-template a {
    color: #ffd89b;
    text-decoration: none;
}

.gradient-pro-template hr {
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.6), transparent);
    height: 2px;
    border: none;
    margin: 30px 0;
}
.gradient-pro-template h3,
.gradient-pro-template h4,
.gradient-pro-template h5,
.gradient-pro-template h6,
.gradient-pro-template p, 
.gradient-pro-template li, 
.gradient-pro-template div, 
.gradient-pro-template span,
.gradient-pro-template blockquote {
    font-family: 'Space Grotesk', sans-serif !important;
}

.gradient-pro-template code {
    font-family: 'Courier New', monospace !important;
}

.gradient-pro-template mark {
                padding: 3px 6px;
                border-radius: 6px;
                font-weight: 600;
                background: currentColor;
                color: var(--bg-color, white);
                opacity: 0.8;
                mix-blend-mode: multiply;
                box-shadow: 0 0 8px currentColor;
                transition: all 0.2s ease;
            }
/* Retro Vibe Template */
.retro-template {
    background: linear-gradient(135deg, #ff6b35 0%, #f7931e 50%, #ffcd3c 100%);
    color: #2c3e50;
    padding: 40px;
    font-family: 'Kalam' ;
    line-height: 1.7;
    position: relative;
    box-shadow: inset 0 0 50px rgba(0,0,0,0.1);
}

.retro-template::before {
    content: '';
    position: absolute;
    top: 20px;
    left: 20px;
    right: 20px;
    bottom: 20px;
    border: 4px solid #2c3e50;
    border-radius: 20px;
    opacity: 0.3;
}

.retro-template::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: repeating-linear-gradient(
        45deg,
        transparent,
        transparent 10px,
        rgba(255,255,255,0.1) 10px,
        rgba(255,255,255,0.1) 20px
    );
    pointer-events: none;
}

.retro-template > * {
    position: relative;
    z-index: 1;
}

.retro-template h1 {
    font-size: 2.8rem;
    font-weight: 700;
    color: #2c3e50;
    margin-bottom: 30px;
    text-align: center;
    text-shadow: 3px 3px 0px rgba(255,255,255,0.8);
    transform: rotate(-2deg);
}

.retro-template h2 {
    font-size: 2.2rem;
    font-weight: 700;
    color: #34495e;
    margin: 35px 0 25px 0;
    text-shadow: 2px 2px 0px rgba(255,255,255,0.7);
    transform: rotate(1deg);
}

.retro-template h3 {
    font-size: 1.8rem;
    font-weight: 400;
    color: #2c3e50;
    margin: 25px 0 15px 0;
    transform: rotate(-0.5deg);
}

.retro-template p {
    font-size: 1.1rem;
    margin-bottom: 20px;
    color: #34495e;
    text-shadow: 1px 1px 0px rgba(255,255,255,0.5);
}

.retro-template ul, .retro-template ol {
    margin: 20px 0;
    padding-left: 0;
}

.retro-template li {
    list-style: none;
    margin: 15px 0;
    padding-left: 40px;
    position: relative;
    color: #2c3e50;
    transform: rotate(0.3deg);
}

.retro-template li:nth-child(even) {
    transform: rotate(-0.3deg);
}

.retro-template li::before {
    content: '‚òÖ';
    position: absolute;
    left: 0;
    color: #e74c3c;
    font-size: 1.5rem;
    text-shadow: 2px 2px 0px rgba(255,255,255,0.7);
}

.retro-template code {
    background: rgba(255,255,255,0.8);
    border: 3px solid #2c3e50;
    padding: 15px;
    border-radius: 15px;
    display: block;
    font-family: 'Courier New', monospace;
    color: #2c3e50;
    margin: 20px 0;
    white-space: pre-wrap;
    overflow-x: auto;
    line-height: 1.4;
    transform: rotate(-1deg);
    box-shadow: 5px 5px 0px rgba(0,0,0,0.2);
}

.retro-template table {
    width: 100%;
    border-collapse: separate;
    border-spacing: 0;
    margin: 25px 0;
    background: rgba(255,255,255,0.9);
    border: 3px solid #2c3e50;
    border-radius: 15px;
    overflow: hidden;
    transform: rotate(0.5deg);
    box-shadow: 5px 5px 0px rgba(0,0,0,0.2);
}

.retro-template th, .retro-template td {
    padding: 15px;
    text-align: left;
    border-bottom: 2px solid #2c3e50;
    border-right: 2px solid #2c3e50;
}

.retro-template th {
    background: #e74c3c;
    color: white;
    font-weight: 700;
    text-shadow: 1px 1px 0px rgba(0,0,0,0.3);
}

.retro-template th:last-child,
.retro-template td:last-child {
    border-right: none;
}

.retro-template tr:last-child td {
    border-bottom: none;
}

.retro-template  mark {
                padding: 3px 6px;
                border-radius: 6px;
                font-weight: 600;
                background: currentColor;
                color: var(--bg-color, white);
                opacity: 0.8;
                mix-blend-mode: multiply;
                box-shadow: 0 0 8px currentColor;
                transition: all 0.2s ease;
            }

/* Glass Morph Template */
.glass-morph-template {
    background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
    color: #2d3436;
    font-family: 'Inter', sans-serif;
}

.glass-morph-template::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(255,255,255,0.25);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255,255,255,0.18);
}

.glass-morph-template > * {
    position: relative;
    z-index: 1;
}

.glass-morph-template h1 {
    font-size: 2.5rem;
    font-weight: 800;
    color: #667eea;
    text-align: center;
    text-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.glass-morph-template h2 {
    font-size: 2rem;
    font-weight: 700;
    color: #f5576c;
}

.glass-morph-template strong {
    color: #667eea;
    font-weight: 800;
}

.glass-morph-template a {
    color: #f5576c;
    text-decoration: none;
}

.glass-morph-template li::before {
    content: 'üíé';
    font-size: 1.2rem;
}

.glass-morph-template pre, .glass-morph-template p code {
    background: rgba(255,255,255,0.4);
    backdrop-filter: blur(15px);
    border: 1px solid rgba(255,255,255,0.3);
    color: #2d3436;
    box-shadow: 0 8px 32px rgba(0,0,0,0.1);
}

.glass-morph-template table {
    background: rgba(255,255,255,0.3);
    backdrop-filter: blur(15px);
    border: 1px solid rgba(255,255,255,0.3);
    box-shadow: 0 8px 32px rgba(0,0,0,0.1);
}

.glass-morph-template th {
    background: rgba(255,255,255,0.4);
    color: #2d3436;
    font-weight: 700;
    backdrop-filter: blur(20px);
}

.glass-morph-template th, .glass-morph-template td {
    border-bottom: 1px solid rgba(255,255,255,0.3);
    font-family: 'Inter', sans-serif;
}

.glass-morph-template td {
    background: rgba(255,255,255,0.2);
    backdrop-filter: blur(10px);
}

.glass-morph-template blockquote {
    border-left: 4px solid rgba(102, 126, 234, 0.6);
    background: rgba(255,255,255,0.3);
    backdrop-filter: blur(15px);
    border-radius: 15px;
    box-shadow: 0 8px 32px rgba(0,0,0,0.1);
}


.glass-morph-template hr {
    background: linear-gradient(90deg, transparent, rgba(102, 126, 234, 0.6), transparent);
    height: 2px;
    border: none;
    margin: 30px 0;
    border-radius: 1px;
}

.glass-morph-template h3,
.glass-morph-template h4,
.glass-morph-template h5,
.glass-morph-template h6,
.glass-morph-template p, 
.glass-morph-template li, 
.glass-morph-template div, 
.glass-morph-template span,
.glass-morph-template blockquote {
    font-family: 'Inter', sans-serif !important;
}

.glass-morph-template code {
    font-family: 'Courier New', monospace !important;
}

.glass-morph-template  mark {
                padding: 3px 6px;
                border-radius: 6px;
                font-weight: 600;
                background: currentColor;
                color: var(--bg-color, white);
                opacity: 0.8;
                mix-blend-mode: multiply;
                box-shadow: 0 0 8px currentColor;
                transition: all 0.2s ease;
            }

/* LaTeX Book Style Template - Elegant Notepad Style */
.latex-book-template {
    background: #f9f9f9;
    color: #1a1a1a;
    font-family: 'Crimson Text', 'Times New Roman', serif;
    line-height: 1.7;
    font-size: 16px;
    padding: 40px;
    position: relative;
    min-height: 100vh;
    /* Notepad paper texture */
    background-image: 
        linear-gradient(rgba(0,0,0,0.05) 1px, transparent 1px),
        linear-gradient(90deg, rgba(0,0,0,0.02) 1px, transparent 1px);
    background-size: 100% 30px, 30px 100%;
    background-position: 0 0, 0 0;
}

/* Elegant paper texture overlay */
.latex-book-template::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: 
        radial-gradient(circle at 20% 80%, rgba(0,0,0,0.008) 0%, transparent 50%),
        radial-gradient(circle at 80% 20%, rgba(0,0,0,0.008) 0%, transparent 50%);
    pointer-events: none;
    z-index: 0;
}

/* Dark margin line (like notebook paper) */
.latex-book-template::after {
    content: '';
    position: absolute;
    top: 0;
    bottom: 0;
    left: 80px;
    width: 2px;
    background: rgba(0,0,0,0.15);
    z-index: 0;
}

.latex-book-template > * {
    position: relative;
    z-index: 1;
}

/* Typography Hierarchy */
.latex-book-template h1 {
    font-family: 'Playfair Display', 'Times New Roman', serif;
    font-size: 2.8rem;
    font-weight: 700;
    color: #1a1a1a;
    text-align: center;
    margin: 0 0 2rem 0;
    letter-spacing: -0.5px;
    text-shadow: 0 1px 2px rgba(0,0,0,0.1);
    position: relative;
}

.latex-book-template h1::after {
    content: '';
    display: block;
    width: 120px;
    height: 3px;
    background: linear-gradient(90deg, transparent, #333333, transparent);
    margin: 1rem auto 0;
}

.latex-book-template h2 {
    font-family: 'Playfair Display', serif;
    font-size: 2.2rem;
    font-weight: 600;
    color: #1a1a1a;
    margin: 2.5rem 0 1.5rem 0;
    border-bottom: 2px solid #cccccc;
    padding-bottom: 0.5rem;
    position: relative;
}

.latex-book-template h3 {
    font-family: 'Playfair Display', serif;
    font-size: 1.6rem;
    font-weight: 600;
    color: #2a2a2a;
    margin: 2rem 0 1rem 0;
    position: relative;
}

.latex-book-template h4,
.latex-book-template h5,
.latex-book-template h6 {
    font-family: 'Crimson Text', serif;
    font-weight: 600;
    color: #333333;
    margin: 1.5rem 0 0.8rem 0;
}

/* Paragraphs and Body Text - No indentation for notepad style */
.latex-book-template p {
    font-family: 'Crimson Text', serif;
    font-size: 16px;
    line-height: 1.8;
    color: #1a1a1a;
    margin: 0 0 1.2rem 0;
    text-align: left; /* Left align for notepad style */
}

/* Lists */
.latex-book-template ul,
.latex-book-template ol {
    margin: 1.5rem 0;
    padding-left: 0;
    list-style: none;
}

.latex-book-template li {
    font-family: 'Crimson Text', serif;
    font-size: 16px;
    line-height: 1.8;
    color: #1a1a1a;
    margin: 0.8rem 0;
    padding-left: 2rem;
    position: relative;
    text-align: left;
}

.latex-book-template ul li::before {
    content: '‚Ä¢';
    color: #333333;
    font-size: 1.2rem;
    position: absolute;
    left: 0.5rem;
    top: 0;
}

.latex-book-template ol {
    counter-reset: list-counter;
}

.latex-book-template ol li::before {
    content: counter(list-counter) ".";
    counter-increment: list-counter;
    color: #333333;
    font-weight: 600;
    position: absolute;
    left: 0;
    top: 0;
    min-width: 1.5rem;
}

/* Code Blocks - Cleaner notepad style */
.latex-book-template pre {
    background: #f5f5f5;
    border: 1px solid #cccccc;
    border-left: 4px solid #333333;
    border-radius: 6px;
    padding: 1.5rem;
    margin: 2rem 0;
    font-family: 'JetBrains Mono', 'Courier New', monospace;
    font-size: 14px;
    line-height: 1.6;
    color: #1a1a1a;
    overflow-x: auto;
    box-shadow: 0 2px 8px rgba(0,0,0,0.08);
    position: relative;
}

.latex-book-template pre::before {
    content: 'Code';
    position: absolute;
    top: -10px;
    left: 20px;
    background: #f5f5f5;
    color: #555555;
    font-size: 12px;
    font-weight: 600;
    padding: 0 8px;
    font-family: 'Crimson Text', serif;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.latex-book-template code {
    background: #f0f0f0;
    border: 1px solid #cccccc;
    border-radius: 4px;
    padding: 2px 6px;
    font-family: 'JetBrains Mono', 'Courier New', monospace;
    font-size: 14px;
    color: #333333;
    font-weight: 500;
}

.latex-book-template p code {
    background: #f0f0f0;
    color: #333333;
}

/* Tables - Clean notepad style, no shadow chopping */
.latex-book-template table {
    width: 100%;
    border-collapse: separate;
    border-spacing: 0;
    margin: 2rem 0;
    background: #ffffff;
    border: 1px solid #cccccc;
    border-radius: 6px;
    overflow: hidden;
    font-family: 'Crimson Text', serif;
}

.latex-book-template th {
    background: linear-gradient(135deg, #f5f5f5, #e9e9e9);
    color: #1a1a1a;
    font-weight: 700;
    text-align: left;
    padding: 1rem 1.5rem;
    border-bottom: 2px solid #333333;
    font-size: 15px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.latex-book-template td {
    padding: 1rem 1.5rem;
    border-bottom: 1px solid #e0e0e0;
    color: #1a1a1a;
    font-size: 15px;
    line-height: 1.6;
}

.latex-book-template tr:last-child td {
    border-bottom: none;
}

.latex-book-template tr:nth-child(even) td {
    background: #f9f9f9;
}

/* Blockquotes - Notepad style */
.latex-book-template blockquote {
    position: relative;
    margin: 2rem 0;
    padding: 1.5rem 2rem 1.5rem 3rem;
    background: #f5f5f5;
    border-left: 4px solid #333333;
    border-radius: 6px;
    font-family: 'Playfair Display', serif;
    font-style: italic;
    font-size: 17px;
    line-height: 1.8;
    color: #2a2a2a;
    box-shadow: 0 2px 8px rgba(0,0,0,0.04);
}

.latex-book-template blockquote::before {
    content: '"';
    position: absolute;
    top: 10px;
    left: 15px;
    font-size: 3rem;
    color: #333333;
    font-family: 'Playfair Display', serif;
    font-weight: 700;
    line-height: 1;
    opacity: 0.6;
}

.latex-book-template blockquote p {
    margin: 0;
}

/* Strong and Emphasis */
.latex-book-template strong {
    color: #1a1a1a;
    font-weight: 700;
    font-family: 'Crimson Text', serif;
}

.latex-book-template em {
    font-style: italic;
    color: #3a3a3a;
}

/* Links - Notepad style */
.latex-book-template a {
    color: #333333;
    text-decoration: none;
    border-bottom: 1px solid transparent;
    transition: all 0.3s ease;
    font-weight: 500;
}

.latex-book-template a:hover {
    color: #000000;
    border-bottom-color: #000000;
}

/* Horizontal Rules - Simple notepad style */
.latex-book-template hr {
    border: none;
    height: 1px;
    background: linear-gradient(90deg, transparent, #333333, transparent);
    margin: 3rem 0;
    position: relative;
}

.latex-book-template hr::after {
    content: '‚ú¶';
    position: absolute;
    top: -10px;
    left: 50%;
    transform: translateX(-50%);
    background: #f9f9f9;
    color: #333333;
    font-size: 16px;
    padding: 0 10px;
}

/* Mark/Highlight - Notepad style highlighting */
.latex-book-template mark {
    background: linear-gradient(135deg, #f0f0f0, #e8e8e8);
    color: #1a1a1a;
    padding: 2px 6px;
    border-radius: 3px;
    font-weight: 600;
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    border: 1px solid #cccccc;
}

/* Font declarations for all elements */
.latex-book-template h3,
.latex-book-template h4,
.latex-book-template h5,
.latex-book-template h6,
.latex-book-template div,
.latex-book-template span {
    font-family: 'Crimson Text', serif !important;
}

    </style>
</head>
<body>
    <div class="preview-container">
        <div class="tech-neural-template template-base" id="preview">
        <!-- <div class="tech-neural-template" id="preview"></div> -->
            <h1>Professional Carousel Templates üöÄ</h1>
            <p>Choose from 10 industry-specific templates designed for maximum impact.</p>
            <h2>Features:</h2>
            <ul>
                <li>Complete markdown syntax support</li>
                <li>Industry-specific styling</li>
                <li>Professional export options</li>
                <li>Mobile-responsive design</li>
            </ul>
        </div>
    </div>

    <script>
        let currentTemplate = 'tech-neural';

        // Configure marked options for proper markdown parsing
        marked.setOptions({
            breaks: true,
            gfm: true,
            tables: true,
            sanitize: false,
            smartLists: true,
            smartypants: true
        });

        async function downloadImage() {
            const preview = document.getElementById('preview');
            
            if (!preview.innerHTML.trim()) {
                alert('Please add some content before downloading!');
                return;
            }
            
            try {
                // Create a temporary container for the image
                const tempContainer = document.createElement('div');
                tempContainer.style.position = 'absolute';
                tempContainer.style.left = '-9999px';
                tempContainer.style.width = '1080px'; 
                tempContainer.innerHTML = preview.outerHTML;
                
                // ‚úÖ ADD WATERMARK - shortest way
                const watermark = document.createElement('div');
                watermark.innerHTML = 'GENERATED WITH GENIUSPOST AI';
                watermark.style.cssText = `
                    position: absolute; 
                    bottom: 20px; 
                    left: 50%; 
                    transform: translateX(-50%); 
                    font-family: 'Space Grotesk', sans-serif; 
                    font-size: 18px; 
                    font-weight: 700; 
                    color: #2c3e50; 
                    background: rgba(255,255,255,0.9); 
                    padding: 8px 16px; 
                    border-radius: 20px; 
                    letter-spacing: 1px; 
                    text-transform: uppercase; 
                    z-index: 9999; 
                    box-shadow: 0 2px 8px rgba(0,0,0,0.15);
                `;
                tempContainer.firstChild.style.position = 'relative';
                tempContainer.firstChild.appendChild(watermark);
                
                document.body.appendChild(tempContainer);
                
                // Set background color based on template
                let backgroundColor = '#ffffff';
                if (currentTemplate.includes('tech-neural')) backgroundColor = '#667eea';
                else if (currentTemplate.includes('tech-quantum')) backgroundColor = '#0a0a0a';
                else if (currentTemplate.includes('product-modern')) backgroundColor = '#ff6b6b';
                else if (currentTemplate.includes('product-premium')) backgroundColor = '#2c3e50';
                else if (currentTemplate.includes('finance-gold')) backgroundColor = '#f7931e';
                else if (currentTemplate.includes('finance-elite')) backgroundColor = '#1e3c72';
                else if (currentTemplate.includes('health-care')) backgroundColor = '#56ab2f';
                else if (currentTemplate.includes('health-medical')) backgroundColor = '#0f4c75';
                else if (currentTemplate.includes('saas-modern')) backgroundColor = '#667eea';
                else if (currentTemplate.includes('saas-enterprise')) backgroundColor = '#2c3e50';
                else if (currentTemplate.includes('dark-neon')) backgroundColor = '#0f0f23';
                else if (currentTemplate.includes('sketchy-minimal')) backgroundColor = '#fefefe';
                else if (currentTemplate.includes('executive-board')) backgroundColor = '#f8f9fa';
                else if (currentTemplate.includes('gradient-pro')) backgroundColor = '#667eea';
                else if (currentTemplate.includes('retro')) backgroundColor = '#ff6b35';
                else if (currentTemplate.includes('glass-morph')) backgroundColor = '#a8edea';
                else if (currentTemplate.includes('latex-book')) backgroundColor = '#fefefe';

                const canvas = await html2canvas(tempContainer.firstChild, {
                    backgroundColor: backgroundColor,
                    scale: 2,
                    useCORS: true,
                    allowTaint: true,
                    width: 1080,
                    height: null,
                    logging: false
                });
                
                document.body.removeChild(tempContainer);
                
                // Download the image
                const link = document.createElement('a');
                link.download = `carousel-${currentTemplate}-${Date.now()}.png`;
                link.href = canvas.toDataURL('image/png');
                link.click();
                
            } catch (error) {
                console.error('Error generating image:', error);
                alert('Error generating image. Please try again.');
            }
        }

        async function downloadPDF() {
            const preview = document.getElementById('preview');
            
            if (!preview.innerHTML.trim()) {
                alert('Please add some content before downloading!');
                return;
            }
            
            try {
                // Show loading indicator
                const originalText = 'Download PDF';
                const downloadBtn = document.querySelector('[onclick="downloadPDF()"]');
                if (downloadBtn) {
                    downloadBtn.textContent = 'Converting images...';
                    downloadBtn.disabled = true;
                }
                
                // ‚úÖ CRITICAL: Convert blob URLs to base64 FIRST
                console.log('Converting blob URLs to base64...');
                const contentWithBase64Images = await convertBlobUrlsToBase64(preview.innerHTML);
                console.log('Blob conversion complete');
                
                // Update button text
                if (downloadBtn) {
                    downloadBtn.textContent = 'Generating PDF...';
                }
                
                // Capture all current styles from the page
                const allStyles = [];
                
                // Get all stylesheets
                for (let i = 0; i < document.styleSheets.length; i++) {
                    try {
                        const styleSheet = document.styleSheets[i];
                        if (styleSheet.cssRules) {
                            for (let j = 0; j < styleSheet.cssRules.length; j++) {
                                allStyles.push(styleSheet.cssRules[j].cssText);
                            }
                        }
                    } catch (e) {
                        console.log('Could not access stylesheet:', e);
                    }
                }
                
                // Get inline styles from style tags
                const styleTags = document.querySelectorAll('style');
                styleTags.forEach(tag => {
                    allStyles.push(tag.innerHTML);
                });
                
                // Combine all styles
                const combinedStyles = allStyles.join('\n');
                
                console.log('Captured styles length:', combinedStyles.length);
                console.log('Current template:', currentTemplate);
                
                // Send request to backend for PDF generation
                const response = await fetch('/generate-pdf', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Accept': 'application/json'
                    },
                    body: JSON.stringify({
                        content: contentWithBase64Images,  // ‚úÖ Now contains base64 images instead of blob URLs
                        template: currentTemplate || 'tech-neural',
                        styles: combinedStyles
                    })
                });
                
                if (!response.ok) {
                    const errorText = await response.text();
                    throw new Error(`Server error (${response.status}): ${errorText}`);
                }
                
                const result = await response.json();
                
                if (!result.success) {
                    throw new Error(result.error || 'PDF generation failed');
                }
                
                // Convert base64 to blob and download
                const pdfBlob = base64ToBlob(result.pdf_data, 'application/pdf');
                const downloadUrl = URL.createObjectURL(pdfBlob);
                
                // Create download link and trigger download
                const downloadLink = document.createElement('a');
                downloadLink.href = downloadUrl;
                downloadLink.download = result.filename;
                downloadLink.style.display = 'none';
                
                document.body.appendChild(downloadLink);
                downloadLink.click();
                document.body.removeChild(downloadLink);
                
                // Clean up URL
                URL.revokeObjectURL(downloadUrl);
                
                console.log('PDF downloaded successfully');
                
            } catch (error) {
                console.error('Error generating PDF:', error);
                alert(`Error generating PDF: ${error.message}`);
            } finally {
                // Reset button state
                const downloadBtn = document.querySelector('[onclick="downloadPDF()"]');
                if (downloadBtn) {
                    downloadBtn.textContent = originalText;
                    downloadBtn.disabled = false;
                }
            }
        }


        // Helper function to convert base64 to blob
        function base64ToBlob(base64Data, contentType = '') {
            const byteCharacters = atob(base64Data);
            const byteArrays = [];
            
            for (let offset = 0; offset < byteCharacters.length; offset += 512) {
                const slice = byteCharacters.slice(offset, offset + 512);
                const byteNumbers = new Array(slice.length);
                
                for (let i = 0; i < slice.length; i++) {
                    byteNumbers[i] = slice.charCodeAt(i);
                }
                
                const byteArray = new Uint8Array(byteNumbers);
                byteArrays.push(byteArray);
            }
            
            return new Blob(byteArrays, { type: contentType });
        }

        async function convertBlobUrlsToBase64(htmlContent) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = htmlContent;
            
            const images = tempDiv.querySelectorAll('img');
            
            for (let img of images) {
                try {
                    const src = img.src;
                    
                    // Skip if not a blob URL or already base64
                    if (!src.startsWith('blob:') && !src.startsWith('data:')) {
                        continue;
                    }
                    
                    // Skip if already base64
                    if (src.startsWith('data:')) {
                        continue;
                    }
                    
                    console.log('Converting blob URL:', src);
                    
                    // Convert blob URL to base64
                    const base64 = await blobUrlToBase64(src);
                    img.src = base64;
                    
                    console.log('Successfully converted blob to base64');
                    
                } catch (error) {
                    console.warn('Failed to convert blob URL:', img.src, error);
                    // Keep original src - will be handled by fallback
                }
            }
            
            return tempDiv.innerHTML;
        }
        
        function blobUrlToBase64(blobUrl) {
            return new Promise((resolve, reject) => {
                try {
                    // Create an image element to load the blob
                    const img = new Image();
                    img.crossOrigin = 'anonymous';
                    
                    img.onload = function() {
                        try {
                            // Create canvas and draw the image
                            const canvas = document.createElement('canvas');
                            const ctx = canvas.getContext('2d');
                            
                            // Set canvas size to match image
                            canvas.width = img.naturalWidth || img.width;
                            canvas.height = img.naturalHeight || img.height;
                            
                            // Draw image on canvas
                            ctx.drawImage(img, 0, 0);
                            
                            // Convert to base64
                            const base64 = canvas.toDataURL('image/png', 0.9);
                            resolve(base64);
                            
                        } catch (canvasError) {
                            console.error('Canvas conversion error:', canvasError);
                            reject(canvasError);
                        }
                    };
                    
                    img.onerror = function(error) {
                        console.error('Image load error:', error);
                        reject(new Error('Failed to load blob image'));
                    };
                    
                    // Load the blob URL
                    img.src = blobUrl;
                    
                } catch (error) {
                    reject(error);
                }
            });
        }

        const preview = document.getElementById('preview');

        window.addEventListener('message', async (event) => {
            const { action, content, template } = event.data;

            if (action === 'updateContent') {
                try {
                    // Parse markdown to HTML first
                    let htmlContent = marked.parse(content || '');
                    
                    //ADD: Process highlighting syntax (same as markdown editor)
                    htmlContent = htmlContent.replace(/==(.*?)==/g, '<mark>$1</mark>');
                    
                    //ADD: Process other syntax if needed
                    htmlContent = htmlContent.replace(/~(.*?)~/g, '<sub>$1</sub>');
                    htmlContent = htmlContent.replace(/\^(.*?)\^/g, '<sup>$1</sup>');
                    
                    preview.innerHTML = htmlContent;
                    preview.className = template + '-template template-base';
                    currentTemplate = template;
                } catch (error) {
                    console.error('Error parsing markdown:', error);
                    preview.innerHTML = content || '';
                    preview.className = template + '-template template-base';
                    currentTemplate = template; 
                }
            }
            else if (action === 'downloadImage') {
                await downloadImage();
            }
            else if (action === 'downloadPDF') {
                await downloadPDF();
            }
        });

        // Initialize with default content
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Carousel template loaded successfully');
        });
    </script>
</body>
</html>
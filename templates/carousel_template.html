<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carousel Templates</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/9.1.2/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600&family=Playfair+Display:wght@400;500;600;700&family=Space+Grotesk:wght@300;400;500;600;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: #f5f5f5;
            min-height: 100vh;
            padding: 0;
            margin: 0;
        }

        .preview-container {
            width: 100%;
            min-height: 100vh;
            background: white;
            overflow: hidden;
        }

        /* Common template styles */
        .template-base {
            padding: 40px;
            min-height: 100vh;
            line-height: 1.6;
            position: relative;
        }

        .template-base h1, .template-base h2, .template-base h3, 
        .template-base h4, .template-base h5, .template-base h6 {
            margin: 20px 0 15px 0;
            font-weight: 600;
        }

        .template-base p {
            margin-bottom: 18px;
        }

        .template-base ul, .template-base ol {
            margin: 20px 0;
            padding-left: 0;
        }

        .template-base li {
            list-style: none;
            margin: 12px 0;
            padding-left: 30px;
            position: relative;
        }

        .template-base pre {
            background: rgba(0,0,0,0.1);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            overflow-x: auto;
            font-family: 'JetBrains Mono', monospace;
        }

        .template-base code {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9em;
        }

        .template-base p code {
            background: rgba(0,0,0,0.1);
            padding: 3px 6px;
            border-radius: 4px;
        }

        .template-base table {
            width: 100%;
            border-collapse: collapse;
            margin: 25px 0;
            border-radius: 8px;
            overflow: hidden;
        }

        .template-base th, .template-base td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid;
        }

        .template-base th {
            font-weight: 600;
        }

        .template-base blockquote {
            margin: 20px 0;
            padding: 15px 20px;
            border-radius: 8px;
            font-style: italic;
            border-left: 4px solid;
        }

        .template-base a {
            text-decoration: none;
            font-weight: 500;
        }

        .template-base a:hover {
            text-decoration: underline;
        }

        .template-base hr {
            border: none;
            height: 2px;
            margin: 30px 0;
        }

        .template-base strong {
            font-weight: 700;
        }

        .template-base em {
            font-style: italic;
        }

        /* Tech Neural Template */
        .tech-neural-template {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-family: 'Space Grotesk', sans-serif;
        }

        .tech-neural-template::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 50%, rgba(255,255,255,0.1), transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255,255,255,0.08), transparent 50%);
            pointer-events: none;
        }

        .tech-neural-template > * {
            position: relative;
            z-index: 1;
        }

        .tech-neural-template h1 {
            font-size: 2.4rem;
            color: #ffffff;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .tech-neural-template h2 {
            font-size: 1.8rem;
            color: #e8f4fd;
            border-bottom: 2px solid rgba(255,255,255,0.3);
            padding-bottom: 8px;
        }

        .tech-neural-template h3 {
            font-size: 1.4rem;
            color: #d1ecf1;
        }

        .tech-neural-template li::before {
            content: '▶';
            position: absolute;
            left: 0;
            color: #ffd700;
        }

        .tech-neural-template pre, .tech-neural-template p code {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            color: #e8f4fd;
        }

        .tech-neural-template table {
            background: rgba(255,255,255,0.1);
        }

        .tech-neural-template th {
            background: rgba(255,255,255,0.2);
            color: #ffffff;
        }

        .tech-neural-template th, .tech-neural-template td {
            border-bottom: 1px solid rgba(255,255,255,0.2);
        }

        .tech-neural-template blockquote {
            border-left-color: #ffd700;
            background: rgba(255,255,255,0.05);
        }

        .tech-neural-template strong {
            color: #ffd700;
        }

        .tech-neural-template a {
            color: #ffd700;
        }

        .tech-neural-template hr {
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
        }

        /* Tech Quantum Template */
        .tech-quantum-template {
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #16213e 100%);
            color: #00d4ff;
            font-family: 'JetBrains Mono', monospace;
        }

        .tech-quantum-template::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                repeating-linear-gradient(
                    90deg,
                    transparent,
                    transparent 100px,
                    rgba(0, 212, 255, 0.05) 100px,
                    rgba(0, 212, 255, 0.05) 101px
                );
            pointer-events: none;
        }

        .tech-quantum-template > * {
            position: relative;
            z-index: 1;
        }

        .tech-quantum-template h1 {
            font-size: 2.6rem;
            color: #00d4ff;
            text-shadow: 0 0 20px rgba(0, 212, 255, 0.5);
            font-family: 'Space Grotesk', sans-serif;
        }

        .tech-quantum-template h2 {
            font-size: 1.9rem;
            color: #ff006e;
            text-shadow: 0 0 15px rgba(255, 0, 110, 0.4);
        }

        .tech-quantum-template h3 {
            color: #8338ec;
        }

        .tech-quantum-template p {
            color: #b8c6db;
        }

        .tech-quantum-template li::before {
            content: '>';
            color: #00d4ff;
            font-weight: bold;
        }

        .tech-quantum-template pre, .tech-quantum-template p code {
            background: rgba(0, 212, 255, 0.1);
            border: 1px solid rgba(0, 212, 255, 0.3);
            color: #00d4ff;
        }

        .tech-quantum-template table {
            background: rgba(0, 212, 255, 0.05);
            border: 1px solid rgba(0, 212, 255, 0.2);
        }

        .tech-quantum-template th {
            background: rgba(0, 212, 255, 0.2);
            color: #ffffff;
        }

        .tech-quantum-template th, .tech-quantum-template td {
            border: 1px solid rgba(0, 212, 255, 0.2);
        }

        .tech-quantum-template blockquote {
            border-left-color: #ff006e;
            background: rgba(255, 0, 110, 0.05);
        }

        .tech-quantum-template strong {
            color: #ff006e;
        }

        .tech-quantum-template a {
            color: #8338ec;
        }

        .tech-quantum-template hr {
            background: linear-gradient(90deg, transparent, #00d4ff, transparent);
        }

        /* Product Modern Template */
        .product-modern-template {
            background: linear-gradient(135deg, #ff6b6b 0%, #feca57 100%);
            color: #2c3e50;
            font-family: 'Inter', sans-serif;
        }

        .product-modern-template::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 80% 20%, rgba(255,255,255,0.2), transparent 50%),
                radial-gradient(circle at 20% 80%, rgba(255,255,255,0.1), transparent 50%);
            pointer-events: none;
        }

        .product-modern-template > * {
            position: relative;
            z-index: 1;
        }

        .product-modern-template h1 {
            font-size: 2.8rem;
            font-weight: 800;
            color: #ffffff;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .product-modern-template h2 {
            font-size: 2rem;
            font-weight: 700;
            color: #2c3e50;
        }

        .product-modern-template h3 {
            color: #34495e;
        }

        .product-modern-template li::before {
            content: '✓';
            color: #27ae60;
            font-weight: bold;
            font-size: 1.2rem;
        }

        .product-modern-template pre, .product-modern-template p code {
            background: rgba(255,255,255,0.8);
            border: 1px solid rgba(44, 62, 80, 0.2);
            color: #2c3e50;
        }

        .product-modern-template table {
            background: rgba(255,255,255,0.9);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .product-modern-template th {
            background: rgba(44, 62, 80, 0.8);
            color: #ffffff;
        }

        .product-modern-template th, .product-modern-template td {
            border-bottom: 1px solid rgba(44, 62, 80, 0.1);
        }

        .product-modern-template blockquote {
            border-left-color: #27ae60;
            background: rgba(255,255,255,0.6);
        }

        .product-modern-template strong {
            color: #e74c3c;
        }

        .product-modern-template a {
            color: #3498db;
        }

        .product-modern-template hr {
            background: linear-gradient(90deg, transparent, rgba(44, 62, 80, 0.3), transparent);
        }

        /* Product Premium Template */
        .product-premium-template {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: #ecf0f1;
            font-family: 'Playfair Display', serif;
        }

        .product-premium-template::before {
            content: '';
            position: absolute;
            top: 20px;
            left: 20px;
            right: 20px;
            bottom: 20px;
            border: 2px solid rgba(236, 240, 241, 0.2);
            border-radius: 15px;
            pointer-events: none;
        }

        .product-premium-template > * {
            position: relative;
            z-index: 1;
        }

        .product-premium-template h1 {
            font-size: 3rem;
            font-weight: 700;
            color: #f1c40f;
            text-align: center;
            font-family: 'Playfair Display', serif;
        }

        .product-premium-template h2 {
            font-size: 2.2rem;
            color: #e67e22;
            font-family: 'Playfair Display', serif;
        }

        .product-premium-template h3 {
            color: #95a5a6;
        }

        .product-premium-template p {
            font-family: 'Inter', sans-serif;
        }

        .product-premium-template li {
            font-family: 'Inter', sans-serif;
        }

        .product-premium-template li::before {
            content: '◆';
            color: #f1c40f;
        }

        .product-premium-template pre, .product-premium-template p code {
            background: rgba(236, 240, 241, 0.1);
            border: 1px solid rgba(241, 196, 15, 0.3);
            color: #f1c40f;
        }

        .product-premium-template table {
            background: rgba(236, 240, 241, 0.05);
        }

        .product-premium-template th {
            background: rgba(241, 196, 15, 0.2);
            color: #2c3e50;
            font-family: 'Inter', sans-serif;
        }

        .product-premium-template th, .product-premium-template td {
            border-bottom: 1px solid rgba(241, 196, 15, 0.2);
            font-family: 'Inter', sans-serif;
        }

        .product-premium-template blockquote {
            border-left-color: #e67e22;
            background: rgba(236, 240, 241, 0.05);
            font-family: 'Playfair Display', serif;
        }

        .product-premium-template strong {
            color: #f1c40f;
        }

        .product-premium-template a {
            color: #e67e22;
        }

        .product-premium-template hr {
            background: linear-gradient(90deg, transparent, #f1c40f, transparent);
        }

        /* Finance Gold Template */
        .finance-gold-template {
            background: linear-gradient(135deg, #f7931e 0%, #ffd700 100%);
            color: #2c3e50;
            font-family: 'Space Grotesk', sans-serif;
        }

        .finance-gold-template::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 10% 20%, rgba(255,255,255,0.3), transparent 40%),
                radial-gradient(circle at 90% 80%, rgba(255,255,255,0.2), transparent 40%);
            pointer-events: none;
        }

        .finance-gold-template > * {
            position: relative;
            z-index: 1;
        }

        .finance-gold-template h1 {
            font-size: 2.8rem;
            font-weight: 800;
            color: #1a1a1a;
            text-align: center;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .finance-gold-template h2 {
            font-size: 2rem;
            color: #8b4513;
            border-bottom: 3px solid #8b4513;
            padding-bottom: 8px;
        }

        .finance-gold-template h3 {
            color: #2c3e50;
        }

        .finance-gold-template p {
            font-weight: 500;
        }

        .finance-gold-template li::before {
            content: '$';
            color: #8b4513;
            font-weight: bold;
            font-size: 1.2rem;
        }

        .finance-gold-template pre, .finance-gold-template p code {
            background: rgba(0,0,0,0.1);
            border: 2px solid #8b4513;
            color: #2c3e50;
            font-weight: 600;
        }

        .finance-gold-template table {
            background: rgba(0,0,0,0.05);
            border: 2px solid #8b4513;
        }

        .finance-gold-template th {
            background: #8b4513;
            color: #ffd700;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .finance-gold-template th, .finance-gold-template td {
            border-bottom: 1px solid #8b4513;
            font-weight: 500;
        }

        .finance-gold-template blockquote {
            border-left-color: #8b4513;
            background: rgba(0,0,0,0.05);
            font-weight: 600;
        }

        .finance-gold-template strong {
            color: #8b4513;
            font-weight: 800;
        }

        .finance-gold-template a {
            color: #8b4513;
        }

        .finance-gold-template hr {
            background: linear-gradient(90deg, transparent, #8b4513, transparent);
        }

        /* Finance Elite Template */
        .finance-elite-template {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: #ffffff;
            font-family: 'Inter', sans-serif;
        }

        .finance-elite-template::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #ffd700, #ffffff, #ffd700);
        }

        .finance-elite-template::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #ffd700, #ffffff, #ffd700);
        }

        .finance-elite-template > * {
            position: relative;
            z-index: 1;
        }

        .finance-elite-template h1 {
            font-size: 2.6rem;
            color: #ffd700;
            text-align: center;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .finance-elite-template h2 {
            font-size: 2rem;
            color: #e8f4fd;
            border-left: 4px solid #ffd700;
            padding-left: 20px;
        }

        .finance-elite-template h3 {
            color: #b8dbd9;
        }

        .finance-elite-template li::before {
            content: '■';
            color: #ffd700;
        }

        .finance-elite-template pre, .finance-elite-template p code {
            background: rgba(255, 215, 0, 0.1);
            border: 1px solid rgba(255, 215, 0, 0.3);
            color: #ffd700;
        }

        .finance-elite-template table {
            background: rgba(255, 215, 0, 0.05);
            border: 2px solid #ffd700;
        }

        .finance-elite-template th {
            background: #ffd700;
            color: #1e3c72;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .finance-elite-template th, .finance-elite-template td {
            border-bottom: 1px solid rgba(255, 215, 0, 0.3);
        }

        .finance-elite-template blockquote {
            border-left-color: #ffd700;
            background: rgba(255, 215, 0, 0.05);
            font-size: 1.1rem;
        }

        .finance-elite-template strong {
            color: #ffd700;
        }

        .finance-elite-template a {
            color: #e8f4fd;
        }

        .finance-elite-template hr {
            background: linear-gradient(90deg, transparent, #ffd700, transparent);
        }

        /* Health Care Template */
        .health-care-template {
            background: linear-gradient(135deg, #56ab2f 0%, #a8e6cf 100%);
            color: #2c3e50;
            font-family: 'Inter', sans-serif;
        }

        .health-care-template::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 30% 30%, rgba(255,255,255,0.2), transparent 40%),
                radial-gradient(circle at 70% 70%, rgba(255,255,255,0.15), transparent 40%);
            pointer-events: none;
        }

        .health-care-template > * {
            position: relative;
            z-index: 1;
        }

        .health-care-template h1 {
            font-size: 2.7rem;
            color: #ffffff;
            text-align: center;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .health-care-template h2 {
            font-size: 2rem;
            color: #1e8449;
            border-bottom: 2px solid #1e8449;
            padding-bottom: 8px;
        }

        .health-care-template h3 {
            color: #239b56;
        }

        .health-care-template li::before {
            content: '♥';
            color: #e74c3c;
            font-size: 1.2rem;
        }

        .health-care-template pre, .health-care-template p code {
            background: rgba(255,255,255,0.8);
            border: 2px solid #1e8449;
            color: #1e8449;
        }

        .health-care-template table {
            background: rgba(255,255,255,0.9);
            border: 2px solid #1e8449;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .health-care-template th {
            background: #1e8449;
            color: #ffffff;
        }

        .health-care-template th, .health-care-template td {
            border-bottom: 1px solid #a8e6cf;
        }

        .health-care-template blockquote {
            border-left-color: #e74c3c;
            background: rgba(255,255,255,0.7);
        }

        .health-care-template strong {
            color: #e74c3c;
        }

        .health-care-template a {
            color: #1e8449;
        }

        .health-care-template hr {
            background: linear-gradient(90deg, transparent, #1e8449, transparent);
        }

        /* Health Medical Template */
        .health-medical-template {
            background: linear-gradient(135deg, #0f4c75 0%, #3282b8 100%);
            color: #ffffff;
            font-family: 'Inter', sans-serif;
        }

        .health-medical-template::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                repeating-linear-gradient(
                    45deg,
                    transparent,
                    transparent 20px,
                    rgba(255,255,255,0.02) 20px,
                    rgba(255,255,255,0.02) 40px
                );
            pointer-events: none;
        }

        .health-medical-template > * {
            position: relative;
            z-index: 1;
        }

        .health-medical-template h1 {
            font-size: 2.6rem;
            color: #bbe1fa;
            text-align: center;
            font-family: 'Space Grotesk', sans-serif;
        }

        .health-medical-template h2 {
            font-size: 2rem;
            color: #7fb3d3;
            border-left: 4px solid #bbe1fa;
            padding-left: 20px;
        }

        .health-medical-template h3 {
            color: #c7d2fe;
        }

        .health-medical-template li::before {
            content: '+';
            color: #bbe1fa;
            font-weight: bold;
            font-size: 1.5rem;
        }

        .health-medical-template pre, .health-medical-template p code {
            background: rgba(187, 225, 250, 0.1);
            border: 1px solid rgba(187, 225, 250, 0.3);
            color: #bbe1fa;
        }

        .health-medical-template table {
            background: rgba(187, 225, 250, 0.05);
            border: 1px solid rgba(187, 225, 250, 0.3);
        }

        .health-medical-template th {
            background: rgba(187, 225, 250, 0.2);
            color: #0f4c75;
        }

        .health-medical-template th, .health-medical-template td {
            border-bottom: 1px solid rgba(187, 225, 250, 0.2);
        }

        .health-medical-template blockquote {
            border-left-color: #bbe1fa;
            background: rgba(187, 225, 250, 0.05);
        }

        .health-medical-template strong {
            color: #bbe1fa;
        }

        .health-medical-template a {
            color: #7fb3d3;
        }

        .health-medical-template hr {
            background: linear-gradient(90deg, transparent, #bbe1fa, transparent);
        }

        /* SaaS Modern Template */
        .saas-modern-template {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #ffffff;
            font-family: 'Space Grotesk', sans-serif;
        }

        .saas-modern-template::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 25% 25%, rgba(255,255,255,0.1), transparent 50%),
                radial-gradient(circle at 75% 75%, rgba(255,255,255,0.08), transparent 50%);
            pointer-events: none;
        }

        .saas-modern-template > * {
            position: relative;
            z-index: 1;
        }

        .saas-modern-template h1 {
            font-size: 2.8rem;
            font-weight: 800;
            color: #ffffff;
            text-align: center;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .saas-modern-template h2 {
            font-size: 2rem;
            color: #ffd700;
        }

        .saas-modern-template h3 {
            color: #e8f4fd;
        }

        .saas-modern-template p {
            color: rgba(255,255,255,0.95);
        }

        .saas-modern-template li::before {
            content: '→';
            color: #ffd700;
            font-weight: bold;
        }

        .saas-modern-template pre, .saas-modern-template p code {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,215,0,0.3);
            color: #ffd700;
        }

        .saas-modern-template table {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,215,0,0.3);
        }

        .saas-modern-template th {
            background: rgba(255,215,0,0.2);
            color: #ffffff;
        }

        .saas-modern-template th, .saas-modern-template td {
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .saas-modern-template blockquote {
            border-left-color: #ffd700;
            background: rgba(255,255,255,0.05);
        }

        .saas-modern-template strong {
            color: #ffd700;
        }

        .saas-modern-template a {
            color: #e8f4fd;
        }

        .saas-modern-template hr {
            background: linear-gradient(90deg, transparent, #ffd700, transparent);
        }

        /* SaaS Enterprise Template */
        .saas-enterprise-template {
            background: linear-gradient(135deg, #2c3e50 0%, #4a6741 100%);
            color: #ecf0f1;
            font-family: 'Inter', sans-serif;
        }

        .saas-enterprise-template::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                linear-gradient(45deg, transparent 40%, rgba(76, 175, 80, 0.05) 50%, transparent 60%),
                linear-gradient(-45deg, transparent 40%, rgba(76, 175, 80, 0.05) 50%, transparent 60%);
            pointer-events: none;
        }

        .saas-enterprise-template > * {
            position: relative;
            z-index: 1;
        }

        .saas-enterprise-template h1 {
            font-size: 2.6rem;
            color: #4caf50;
            text-align: center;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .saas-enterprise-template h2 {
            font-size: 2rem;
            color: #81c784;
            border-bottom: 2px solid #4caf50;
            padding-bottom: 10px;
        }

        .saas-enterprise-template h3 {
            color: #a5d6a7;
        }

        .saas-enterprise-template li::before {
            content: '◉';
            color: #4caf50;
        }

        .saas-enterprise-template pre, .saas-enterprise-template p code {
            background: rgba(76, 175, 80, 0.1);
            border: 1px solid rgba(76, 175, 80, 0.3);
            color: #4caf50;
        }

        .saas-enterprise-template table {
            background: rgba(76, 175, 80, 0.05);
            border: 2px solid #4caf50;
        }

        .saas-enterprise-template th {
            background: #4caf50;
            color: #2c3e50;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .saas-enterprise-template th, .saas-enterprise-template td {
            border-bottom: 1px solid rgba(76, 175, 80, 0.2);
        }

        .saas-enterprise-template blockquote {
            border-left-color: #4caf50;
            background: rgba(76, 175, 80, 0.05);
        }

        .saas-enterprise-template strong {
            color: #4caf50;
        }

        .saas-enterprise-template a {
            color: #81c784;
        }

        .saas-enterprise-template hr {
            background: linear-gradient(90deg, transparent, #4caf50, transparent);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .template-base {
                padding: 20px;
            }
            
            .template-base h1 {
                font-size: 2rem !important;
            }
            
            .template-base h2 {
                font-size: 1.5rem !important;
            }
            
            .template-base h3 {
                font-size: 1.2rem !important;
            }
        }

        /* Dark Neon Template */
.dark-neon-template {
    background: linear-gradient(135deg, #0f0f23 0%, #1a1a2e 50%, #16213e 100%);
    color: #ffffff;
    font-family: 'Space Grotesk', sans-serif;
}

.dark-neon-template::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: radial-gradient(circle at 20% 50%, rgba(120, 119, 198, 0.3), transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255, 119, 198, 0.3), transparent 50%);
    pointer-events: none;
}

.dark-neon-template > * {
    position: relative;
    z-index: 1;
}

.dark-neon-template h1 {
    font-size: 2.5rem;
    font-weight: 800;
    background: linear-gradient(135deg, #ff006e, #8338ec, #3a86ff);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    text-shadow: 0 0 30px rgba(255, 0, 110, 0.5);
    animation: glow 3s ease-in-out infinite;
}

.dark-neon-template h2 {
    font-size: 2rem;
    font-weight: 700;
    color: #ff006e;
    text-shadow: 0 0 20px rgba(255, 0, 110, 0.3);
}

.dark-neon-template h3 {
    font-size: 1.5rem;
    font-weight: 600;
    color: #8338ec;
    text-shadow: 0 0 15px rgba(131, 56, 236, 0.3);
}

.dark-neon-template li::before {
    content: '▶';
    color: #ff006e;
    font-size: 0.8rem;
    text-shadow: 0 0 10px rgba(255, 0, 110, 0.5);
}

.dark-neon-template pre, .dark-neon-template p code {
    background: rgba(255, 0, 110, 0.1);
    border: 1px solid rgba(255, 0, 110, 0.3);
    color: #3a86ff;
    box-shadow: 0 0 20px rgba(255, 0, 110, 0.1);
}

.dark-neon-template table {
    background: rgba(131, 56, 236, 0.1);
    box-shadow: 0 0 20px rgba(131, 56, 236, 0.2);
}

.dark-neon-template th {
    background: rgba(255, 0, 110, 0.2);
    color: #ffffff;
    text-shadow: 0 0 10px rgba(255, 0, 110, 0.3);
}

.dark-neon-template th, .dark-neon-template td {
    border-bottom: 1px solid rgba(255, 0, 110, 0.2);
}

.dark-neon-template blockquote {
    border-left-color: #ff006e;
    background: rgba(255, 0, 110, 0.05);
    box-shadow: 0 0 15px rgba(255, 0, 110, 0.1);
}

.dark-neon-template strong {
    color: #3a86ff;
    text-shadow: 0 0 10px rgba(58, 134, 255, 0.3);
}

.dark-neon-template a {
    color: #8338ec;
    text-shadow: 0 0 8px rgba(131, 56, 236, 0.3);
}

.dark-neon-template hr {
    background: linear-gradient(90deg, transparent, #ff006e, transparent);
    box-shadow: 0 0 20px rgba(255, 0, 110, 0.3);
}

.dark-neon-template p, 
.dark-neon-template li, 
.dark-neon-template div, 
.dark-neon-template span {
    font-family: 'Inter', sans-serif !important;
}

.dark-neon-template code {
    font-family: 'Courier New', monospace !important;
}
@keyframes glow {
    0%, 100% { text-shadow: 0 0 20px rgba(255, 0, 110, 0.5); }
    50% { text-shadow: 0 0 30px rgba(255, 0, 110, 0.8); }
}

/* Sketchy Minimal Template */
.sketchy-minimal-template {
    background: #fefefe;
    color: #2d3436;
    font-family: 'Kalam', cursive;
    line-height: 1.8;
    position: relative;
}

.sketchy-minimal-template::before {
    content: '';
    position: absolute;
    top: 10px;
    left: 10px;
    right: 10px;
    bottom: 10px;
    border: 3px solid #2d3436;
    border-radius: 25px;
    opacity: 0.1;
    transform: rotate(-1deg);
}

.sketchy-minimal-template::after {
    content: '';
    position: absolute;
    top: 15px;
    left: 15px;
    right: 15px;
    bottom: 15px;
    border: 2px solid #636e72;
    border-radius: 20px;
    opacity: 0.05;
    transform: rotate(1deg);
}

.sketchy-minimal-template > * {
    position: relative;
    z-index: 1;
}

.sketchy-minimal-template h1 {
    font-size: 2.2rem;
    font-weight: 700;
    color: #2d3436;
    text-decoration: underline;
    text-decoration-style: wavy;
    text-underline-offset: 8px;
    transform: rotate(-1deg);
    animation: sketch 4s ease-in-out infinite;
}

.sketchy-minimal-template h2 {
    font-size: 1.8rem;
    font-weight: 700;
    color: #636e72;
    transform: rotate(0.5deg);
    border-bottom: 2px dashed #ddd;
    padding-bottom: 8px;
}

.sketchy-minimal-template h3 {
    font-size: 1.4rem;
    font-weight: 400;
    color: #2d3436;
    transform: rotate(-0.3deg);
}

.sketchy-minimal-template li::before {
    content: '✓';
    color: #00b894;
    font-size: 1.2rem;
    font-weight: bold;
    transform: rotate(-10deg);
}

.sketchy-minimal-template pre, .sketchy-minimal-template p code {
    background: #f8f9fc;
    border: 2px dashed #ddd;
    border-radius: 15px;
    color: #2d3436;
    transform: rotate(0.5deg);
    box-shadow: 3px 3px 0px rgba(0,0,0,0.1);
}

.sketchy-minimal-template table {
    background: #ffffff;
    border: 2px dashed #636e72;
    border-radius: 15px;
    transform: rotate(-0.5deg);
    box-shadow: 3px 3px 0px rgba(0,0,0,0.1);
}

.sketchy-minimal-template th {
    background: #f8f9fc;
    color: #2d3436;
    border-bottom: 2px dashed #ddd;
    font-weight: 700;
    transform: rotate(0.3deg);
}

.sketchy-minimal-template th, .sketchy-minimal-template td {
    border-bottom: 1px dashed #ddd;
    font-family: 'JetBrains Mono', monospace;
}

.sketchy-minimal-template blockquote {
    border-left: 4px dashed #00b894;
    background: #f8f9fc;
    transform: rotate(0.5deg);
    box-shadow: 2px 2px 0px rgba(0,0,0,0.05);
}

.sketchy-minimal-template strong {
    color: #00b894;
    font-weight: 700;
}

.sketchy-minimal-template a {
    color: #636e72;
    text-decoration: underline;
    text-decoration-style: wavy;
}

.sketchy-minimal-template hr {
    border: none;
    height: 2px;
    background: repeating-linear-gradient(90deg, #ddd, #ddd 10px, transparent 10px, transparent 20px);
    margin: 30px 0;
}
@keyframes sketch {
    0%, 100% { transform: rotate(-0.5deg); }
    25% { transform: rotate(0.5deg); }
    75% { transform: rotate(-0.3deg); }
}
.sketchy-minimal-template h1,
.sketchy-minimal-template h2,
.sketchy-minimal-template h3,
.sketchy-minimal-template h4,
.sketchy-minimal-template h5,
.sketchy-minimal-template h6,
.sketchy-minimal-template p, 
.sketchy-minimal-template li, 
.sketchy-minimal-template div, 
.sketchy-minimal-template span,
.sketchy-minimal-template blockquote {
font-family:'Kalam', cursive !important;
}

.sketchy-minimal-template code {
    font-family: 'Courier New', monospace !important;
}

/* Executive Board Template */
.executive-board-template {
    background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
    color: #212529;
    font-family: 'Inter', sans-serif;
    border-left: 6px solid #1e3c72;
}

.executive-board-template::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: linear-gradient(90deg, #1e3c72, #2a5298, #1e3c72);
}

.executive-board-template h1 {
    font-size: 2.8rem;
    font-weight: 700;
    color: #1e3c72;
    text-align: center;
    position: relative;
    padding-bottom: 20px;
}

.executive-board-template h1::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 50%;
    transform: translateX(-50%);
    width: 100px;
    height: 3px;
    background: linear-gradient(90deg, #1e3c72, #2a5298);
    border-radius: 2px;
}

.executive-board-template h2 {
    font-size: 2rem;
    font-weight: 600;
    color: #2a5298;
    border-bottom: 2px solid #dee2e6;
    padding-bottom: 10px;
    position: relative;
}

.executive-board-template h2::before {
    content: '';
    position: absolute;
    left: 0;
    bottom: -2px;
    width: 50px;
    height: 2px;
    background: #1e3c72;
}

.executive-board-template li::before {
    content: '▪';
    color: #1e3c72;
    font-size: 1.5rem;
    font-weight: bold;
    top: -2px;
}

.executive-board-template pre, .executive-board-template p code {
    background: #ffffff;
    border: 1px solid #dee2e6;
    color: #495057;
    box-shadow: 0 2px 10px rgba(0,0,0,0.08);
    border-left: 4px solid #1e3c72;
}

.executive-board-template table {
    background: #ffffff;
    border: 1px solid #dee2e6;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    border-radius: 8px;
    overflow: hidden;
}

.executive-board-template th {
    background: linear-gradient(135deg, #1e3c72, #2a5298);
    color: #ffffff;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.executive-board-template th, .executive-board-template td {
    border-bottom: 1px solid #dee2e6;
    font-family: 'Inter', sans-serif;
    padding: 15px;
}

.executive-board-template td {
    background: #ffffff;
}

.executive-board-template blockquote {
    border-left: 4px solid #1e3c72;
    background: #f8f9fa;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.05);
}

.executive-board-template strong {
    color: #1e3c72;
    font-weight: 700;
}

.executive-board-template a {
    color: #2a5298;
    font-weight: 600;
}

.executive-board-template hr {
    background: linear-gradient(90deg, transparent, #1e3c72, transparent);
    height: 2px;
    border: none;
    margin: 30px 0;
}
.executive-board-template h3,
.executive-board-template h4,
.executive-board-template h5,
.executive-board-template h6,
.executive-board-template p, 
.executive-board-template li, 
.executive-board-template div, 
.executive-board-template span {
    font-family: 'Inter', sans-serif !important;
}

.executive-board-template code {
    font-family: 'Courier New', monospace !important;
}

/* Gradient Pro Template */
.gradient-pro-template {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
    color: white;
    font-family: 'Space Grotesk', sans-serif;
}

.gradient-pro-template::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(45deg, rgba(255,255,255,0.1) 0%, transparent 50%, rgba(255,255,255,0.1) 100%);
    animation: shimmer 3s ease-in-out infinite;
}

@keyframes shimmer {
    0%, 100% { opacity: 0.3; }
    50% { opacity: 0.8; }
}

.gradient-pro-template > * {
    position: relative;
    z-index: 1;
}

.gradient-pro-template h1 {
    font-size: 2.6rem;
    font-weight: 800;
    background: linear-gradient(135deg, #ffffff, #f8f9fa, #ffffff);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    text-align: center;
    text-shadow: 0 2px 4px rgba(0,0,0,0.3);
}

.gradient-pro-template h2 {
    font-size: 2rem;
    font-weight: 700;
    background: linear-gradient(135deg, #ffd89b, #19547b);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.gradient-pro-template li::before {
    content: '✨';
    font-size: 1.2rem;
}

.gradient-pro-template pre, .gradient-pro-template p code {
    background: rgba(255,255,255,0.15);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255,255,255,0.3);
    color: #f8f9fa;
}

.gradient-pro-template table {
    background: rgba(255,255,255,0.1);
    backdrop-filter: blur(15px);
    border: 1px solid rgba(255,255,255,0.3);
    border-radius: 15px;
    overflow: hidden;
    box-shadow: 0 8px 32px rgba(0,0,0,0.2);
}

.gradient-pro-template th {
    background: linear-gradient(135deg, rgba(255,255,255,0.3), rgba(255,255,255,0.1));
    color: #ffffff;
    font-weight: 700;
    backdrop-filter: blur(10px);
}

.gradient-pro-template th, .gradient-pro-template td {
    border-bottom: 1px solid rgba(255,255,255,0.2);
    font-family: 'Space Grotesk', sans-serif;
}

.gradient-pro-template td {
    color: rgba(255,255,255,0.95);
}

.gradient-pro-template blockquote {
    border-left: 4px solid rgba(255,255,255,0.8);
    background: rgba(255,255,255,0.1);
    backdrop-filter: blur(10px);
    border-radius: 10px;
}

.gradient-pro-template strong {
    background: linear-gradient(135deg, #ffd89b, #19547b);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    font-weight: 800;
}

.gradient-pro-template a {
    color: #ffd89b;
    text-decoration: none;
}

.gradient-pro-template hr {
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.6), transparent);
    height: 2px;
    border: none;
    margin: 30px 0;
}
.gradient-pro-template h3,
.gradient-pro-template h4,
.gradient-pro-template h5,
.gradient-pro-template h6,
.gradient-pro-template p, 
.gradient-pro-template li, 
.gradient-pro-template div, 
.gradient-pro-template span,
.gradient-pro-template blockquote {
    font-family: 'Space Grotesk', sans-serif !important;
}

.gradient-pro-template code {
    font-family: 'Courier New', monospace !important;
}
/* Retro Vibe Template */
.retro-template {
    background: linear-gradient(135deg, #ff6b35 0%, #f7931e 50%, #ffcd3c 100%);
    color: #2c3e50;
    padding: 40px;
    font-family: 'Kalam', 'Inter';
    line-height: 1.7;
    position: relative;
    box-shadow: inset 0 0 50px rgba(0,0,0,0.1);
}

.retro-template::before {
    content: '';
    position: absolute;
    top: 20px;
    left: 20px;
    right: 20px;
    bottom: 20px;
    border: 4px solid #2c3e50;
    border-radius: 20px;
    opacity: 0.3;
}

.retro-template::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: repeating-linear-gradient(
        45deg,
        transparent,
        transparent 10px,
        rgba(255,255,255,0.1) 10px,
        rgba(255,255,255,0.1) 20px
    );
    pointer-events: none;
}

.retro-template > * {
    position: relative;
    z-index: 1;
}

.retro-template h1 {
    font-size: 2.8rem;
    font-weight: 700;
    color: #2c3e50;
    margin-bottom: 30px;
    text-align: center;
    text-shadow: 3px 3px 0px rgba(255,255,255,0.8);
    transform: rotate(-2deg);
}

.retro-template h2 {
    font-size: 2.2rem;
    font-weight: 700;
    color: #34495e;
    margin: 35px 0 25px 0;
    text-shadow: 2px 2px 0px rgba(255,255,255,0.7);
    transform: rotate(1deg);
}

.retro-template h3 {
    font-size: 1.8rem;
    font-weight: 400;
    color: #2c3e50;
    margin: 25px 0 15px 0;
    transform: rotate(-0.5deg);
}

.retro-template p {
    font-size: 1.1rem;
    margin-bottom: 20px;
    color: #34495e;
    text-shadow: 1px 1px 0px rgba(255,255,255,0.5);
}

.retro-template ul, .retro-template ol {
    margin: 20px 0;
    padding-left: 0;
}

.retro-template li {
    list-style: none;
    margin: 15px 0;
    padding-left: 40px;
    position: relative;
    color: #2c3e50;
    transform: rotate(0.3deg);
}

.retro-template li:nth-child(even) {
    transform: rotate(-0.3deg);
}

.retro-template li::before {
    content: '★';
    position: absolute;
    left: 0;
    color: #e74c3c;
    font-size: 1.5rem;
    text-shadow: 2px 2px 0px rgba(255,255,255,0.7);
}

.retro-template code {
    background: rgba(255,255,255,0.8);
    border: 3px solid #2c3e50;
    padding: 15px;
    border-radius: 15px;
    display: block;
    font-family: 'Courier New', monospace;
    color: #2c3e50;
    margin: 20px 0;
    white-space: pre-wrap;
    overflow-x: auto;
    line-height: 1.4;
    transform: rotate(-1deg);
    box-shadow: 5px 5px 0px rgba(0,0,0,0.2);
}

.retro-template table {
    width: 100%;
    border-collapse: separate;
    border-spacing: 0;
    margin: 25px 0;
    background: rgba(255,255,255,0.9);
    border: 3px solid #2c3e50;
    border-radius: 15px;
    overflow: hidden;
    transform: rotate(0.5deg);
    box-shadow: 5px 5px 0px rgba(0,0,0,0.2);
}

.retro-template th, .retro-template td {
    padding: 15px;
    text-align: left;
    border-bottom: 2px solid #2c3e50;
    border-right: 2px solid #2c3e50;
}

.retro-template th {
    background: #e74c3c;
    color: white;
    font-weight: 700;
    text-shadow: 1px 1px 0px rgba(0,0,0,0.3);
}

.retro-template th:last-child,
.retro-template td:last-child {
    border-right: none;
}

.retro-template tr:last-child td {
    border-bottom: none;
}
/* Glass Morph Template */
.glass-morph-template {
    background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
    color: #2d3436;
    font-family: 'Inter', sans-serif;
}

.glass-morph-template::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(255,255,255,0.25);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255,255,255,0.18);
}

.glass-morph-template > * {
    position: relative;
    z-index: 1;
}

.glass-morph-template h1 {
    font-size: 2.5rem;
    font-weight: 800;
    background: linear-gradient(135deg, #667eea, #764ba2);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    text-align: center;
    filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1));
}

.glass-morph-template h2 {
    font-size: 2rem;
    font-weight: 700;
    background: linear-gradient(135deg, #f093fb, #f5576c);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.glass-morph-template li::before {
    content: '💎';
    font-size: 1.2rem;
}

.glass-morph-template pre, .glass-morph-template p code {
    background: rgba(255,255,255,0.4);
    backdrop-filter: blur(15px);
    border: 1px solid rgba(255,255,255,0.3);
    color: #2d3436;
    box-shadow: 0 8px 32px rgba(0,0,0,0.1);
}

.glass-morph-template table {
    background: rgba(255,255,255,0.3);
    backdrop-filter: blur(15px);
    border: 1px solid rgba(255,255,255,0.3);
    box-shadow: 0 8px 32px rgba(0,0,0,0.1);
}

.glass-morph-template th {
    background: rgba(255,255,255,0.4);
    color: #2d3436;
    font-weight: 700;
    backdrop-filter: blur(20px);
}

.glass-morph-template th, .glass-morph-template td {
    border-bottom: 1px solid rgba(255,255,255,0.3);
    font-family: 'Inter', sans-serif;
}

.glass-morph-template td {
    background: rgba(255,255,255,0.2);
    backdrop-filter: blur(10px);
}

.glass-morph-template blockquote {
    border-left: 4px solid rgba(102, 126, 234, 0.6);
    background: rgba(255,255,255,0.3);
    backdrop-filter: blur(15px);
    border-radius: 15px;
    box-shadow: 0 8px 32px rgba(0,0,0,0.1);
}

.glass-morph-template strong {
    background: linear-gradient(135deg, #667eea, #764ba2);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    font-weight: 800;
}

.glass-morph-template a {
    background: linear-gradient(135deg, #f093fb, #f5576c);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    text-decoration: none;
}

.glass-morph-template hr {
    background: linear-gradient(90deg, transparent, rgba(102, 126, 234, 0.6), transparent);
    height: 2px;
    border: none;
    margin: 30px 0;
    border-radius: 1px;
}

.glass-morph-template h3,
.glass-morph-template h4,
.glass-morph-template h5,
.glass-morph-template h6,
.glass-morph-template p, 
.glass-morph-template li, 
.glass-morph-template div, 
.glass-morph-template span,
.glass-morph-template blockquote {
    font-family: 'Inter', sans-serif !important;
}

.glass-morph-template code {
    font-family: 'Courier New', monospace !important;
}
    </style>
</head>
<body>
    <div class="preview-container">
        <div class="tech-neural-template template-base" id="preview">
            <h1>Professional Carousel Templates 🚀</h1>
            <p>Choose from 10 industry-specific templates designed for maximum impact.</p>
            <h2>Features:</h2>
            <ul>
                <li>Complete markdown syntax support</li>
                <li>Industry-specific styling</li>
                <li>Professional export options</li>
                <li>Mobile-responsive design</li>
            </ul>
        </div>
    </div>

    <script>
        let currentTemplate = 'tech-neural';

        // Configure marked options for proper markdown parsing
        marked.setOptions({
            breaks: true,
            gfm: true,
            tables: true,
            sanitize: false,
            smartLists: true,
            smartypants: true
        });

        async function downloadImage() {
            const preview = document.getElementById('preview');
            
            if (!preview.innerHTML.trim()) {
                alert('Please add some content before downloading!');
                return;
            }
            
            try {
                // Create a temporary container for the image
                const tempContainer = document.createElement('div');
                tempContainer.style.position = 'absolute';
                tempContainer.style.left = '-9999px';
                tempContainer.style.width = '800px';
                tempContainer.innerHTML = preview.outerHTML;
                document.body.appendChild(tempContainer);
                
                // Set background color based on template
                let backgroundColor = '#ffffff';
                if (currentTemplate.includes('tech-neural')) backgroundColor = '#667eea';
                else if (currentTemplate.includes('tech-quantum')) backgroundColor = '#0a0a0a';
                else if (currentTemplate.includes('product-modern')) backgroundColor = '#ff6b6b';
                else if (currentTemplate.includes('product-premium')) backgroundColor = '#2c3e50';
                else if (currentTemplate.includes('finance-gold')) backgroundColor = '#f7931e';
                else if (currentTemplate.includes('finance-elite')) backgroundColor = '#1e3c72';
                else if (currentTemplate.includes('health-care')) backgroundColor = '#56ab2f';
                else if (currentTemplate.includes('health-medical')) backgroundColor = '#0f4c75';
                else if (currentTemplate.includes('saas-modern')) backgroundColor = '#667eea';
                else if (currentTemplate.includes('saas-enterprise')) backgroundColor = '#2c3e50';
                else if (currentTemplate.includes('dark-neon')) backgroundColor = '#0f0f23';
                else if (currentTemplate.includes('sketchy-minimal')) backgroundColor = '#fefefe';
                else if (currentTemplate.includes('executive-board')) backgroundColor = '#f8f9fa';
                else if (currentTemplate.includes('gradient-pro')) backgroundColor = '#667eea';
                else if (currentTemplate.includes('retro')) backgroundColor = '#ff6b35';
                else if (currentTemplate.includes('glass-morph')) backgroundColor = '#a8edea';

                const canvas = await html2canvas(tempContainer.firstChild, {
                    backgroundColor: backgroundColor,
                    scale: 2,
                    useCORS: true,
                    allowTaint: true,
                    width: 800,
                    height: null,
                    logging: false
                });
                
                document.body.removeChild(tempContainer);
                
                // Download the image
                const link = document.createElement('a');
                link.download = `carousel-${currentTemplate}-${Date.now()}.png`;
                link.href = canvas.toDataURL('image/png');
                link.click();
                
            } catch (error) {
                console.error('Error generating image:', error);
                alert('Error generating image. Please try again.');
            }
        }

        

        async function downloadPDF() {
    const preview = document.getElementById('preview');
    
    if (!preview.innerHTML.trim()) {
        alert('Please add some content before downloading!');
        return;
    }
    
    try {
        // Create a temporary container for the PDF
        const tempContainer = document.createElement('div');
        tempContainer.style.position = 'absolute';
        tempContainer.style.left = '-9999px';
        tempContainer.style.width = '1080px';
        tempContainer.innerHTML = preview.outerHTML;
        document.body.appendChild(tempContainer);
        
        // Set background color based on template
        let backgroundColor = '#ffffff';
        if (currentTemplate.includes('tech-neural')) backgroundColor = '#667eea';
        else if (currentTemplate.includes('tech-quantum')) backgroundColor = '#0a0a0a';
        else if (currentTemplate.includes('product-modern')) backgroundColor = '#ff6b6b';
        else if (currentTemplate.includes('product-premium')) backgroundColor = '#2c3e50';
        else if (currentTemplate.includes('finance-gold')) backgroundColor = '#f7931e';
        else if (currentTemplate.includes('finance-elite')) backgroundColor = '#1e3c72';
        else if (currentTemplate.includes('health-care')) backgroundColor = '#56ab2f';
        else if (currentTemplate.includes('health-medical')) backgroundColor = '#0f4c75';
        else if (currentTemplate.includes('saas-modern')) backgroundColor = '#667eea';
        else if (currentTemplate.includes('saas-enterprise')) backgroundColor = '#2c3e50';
        else if (currentTemplate.includes('dark-neon')) backgroundColor = '#0f0f23';
        else if (currentTemplate.includes('sketchy-minimal')) backgroundColor = '#fefefe';
        else if (currentTemplate.includes('executive-board')) backgroundColor = '#f8f9fa';
        else if (currentTemplate.includes('gradient-pro')) backgroundColor = '#667eea';
        else if (currentTemplate.includes('retro')) backgroundColor = '#ff6b35';
        else if (currentTemplate.includes('glass-morph')) backgroundColor = '#a8edea';
        
        const canvas = await html2canvas(tempContainer.firstChild, {
            backgroundColor: backgroundColor,
            scale: 1.5, // Reduced from 2 to 1.5 - still high quality but smaller file
            useCORS: true,
            allowTaint: true,
            width: 1080,
            height: null,
            logging: false
        });
        
        document.body.removeChild(tempContainer);
        
        // Create PDF with compression
        const { jsPDF } = window.jspdf;
        // Calculate LinkedIn dimensions in mm (1080x1350 aspect ratio)
        const linkedinWidth = 216; // mm (8.5 inches)
        const linkedinHeight = 270; // mm (maintains 1080:1350 ratio)

        const pdf = new jsPDF({
            orientation: 'p',
            unit: 'mm', 
            format: [linkedinWidth, linkedinHeight], // Custom LinkedIn format
            compress: true
        });

        const imgData = canvas.toDataURL('image/jpeg', 0.85);
        const imgWidth = linkedinWidth;
        const pageHeight = linkedinHeight;
        const imgHeight = (canvas.height * imgWidth) / canvas.width;
        let heightLeft = imgHeight;
        
        let position = 0;
        
        pdf.addImage(imgData, 'JPEG', 0, position, imgWidth, imgHeight, undefined, 'FAST');
        heightLeft -= pageHeight;
        
        while (heightLeft >= 0) {
            position = heightLeft - imgHeight;
            pdf.addPage();
            pdf.addImage(imgData, 'JPEG', 0, position, imgWidth, imgHeight, undefined, 'FAST');
            heightLeft -= pageHeight;
        }
        
        pdf.save(`carousel-${currentTemplate}-${Date.now()}.pdf`);
        
    } catch (error) {
        console.error('Error generating PDF:', error);
        alert('Error generating PDF. Please try again.');
    }
} 
       

       
        const preview = document.getElementById('preview');

        window.addEventListener('message', async (event) => {
            const { action, content, template } = event.data;

            if (action === 'updateContent') {
                try {
                    // Parse markdown to HTML first
                    const htmlContent = marked.parse(content || '');
                    preview.innerHTML = htmlContent;
                    preview.className = template + '-template template-base';
                    currentTemplate = template;
                } catch (error) {
                    console.error('Error parsing markdown:', error);
                    preview.innerHTML = content || '';
                    preview.className = template + '-template template-base';
                    currentTemplate = template;
                }
            }
            else if (action === 'downloadImage') {
                await downloadImage();
            }
            else if (action === 'downloadPDF') {
                await downloadPDF();
            }
        });

        // Initialize with default content
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Carousel template loaded successfully');
        });
    </script>
</body>
</html>
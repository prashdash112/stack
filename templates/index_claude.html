<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GeniusPost AI</title>
    <link rel="stylesheet" href="../static/index.css"> 
</head>
<body>
    <!-- Animated Background -->
    <div class="bg-animation"></div>
    
    <!-- Floating Particles -->
    <div class="particles" id="particles"></div>

    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1 class="logo"> GeniusPost AI</h1>
            <p class="tagline">Transform your ideas into engaging LinkedIn posts with AI magic</p>
            {% if current_user.is_authenticated %}
                <div class="user-menu">
                    <span class="user-greeting">Welcome, {{ current_user.name }}.</span>
                    <a href="{{ url_for('logout') }}" class="cta-button">Logout</a>
                </div>
            {% endif %}
        </div>

        <!-- Main Content Grid -->
        <div class="main-grid">
            <!-- Input Section -->
            <div class="input-section">
                <h2 class="section-title">Create Your Post</h2>
                <textarea 
                    class="prompt-input" 
                    id="promptInput"
                    placeholder="Describe your LinkedIn post idea... 

Examples:
• Write about the importance of continuous learning in tech
• Share insights about remote work productivity
• Discuss AI trends in marketing
• Create a motivational post about career growth"
                ></textarea>
                
                <!-- <div class="post-options">
                    <button class="option-btn active" data-format="square">
                        📱 Content
                    </button>
                    <button class="option-btn" data-format="vertical">
                        📋 Flowchart
                    </button>
                </div> -->
                
                <button class="generate-btn" id="generateBtn">
                    <span class="btn-text">Generate AI Content</span>
                    <div class="loading-spinner" id="loadingSpinner"></div>
                </button>
            </div>

            <!-- Benefits Section -->
            <div class="benefits-section">
                <h2 class="section-title">Why Choose AI Content?</h2>
                
                <div class="benefit-item">
                    <div class="benefit-icon">⚡</div>
                    <div class="benefit-text">
                        <div class="benefit-title">Lightning Fast</div>
                        <div class="benefit-desc">Generate professional content in seconds</div>
                    </div>
                </div>

                <div class="benefit-item">
                    <div class="benefit-icon">🎯</div>
                    <div class="benefit-text">
                        <div class="benefit-title">Engagement Optimized</div>
                        <div class="benefit-desc">Content designed for maximum LinkedIn reach</div>
                    </div>
                </div>

                <div class="benefit-item">
                    <div class="benefit-icon">✨</div>
                    <div class="benefit-text">
                        <div class="benefit-title">Professional Quality</div>
                        <div class="benefit-desc">AI-powered writing that sounds human</div>
                    </div>
                </div>

                <div class="benefit-item">
                    <div class="benefit-icon">🔄</div>
                    <div class="benefit-text">
                        <div class="benefit-title">Fully Editable</div>
                        <div class="benefit-desc">Customize and refine before posting</div>
                    </div>
                </div>

                <div class="benefit-item">
                    <div class="benefit-icon">💡</div>
                    <div class="benefit-text">
                        <div class="benefit-title">Creative Ideas</div>
                        <div class="benefit-desc">Never run out of content inspiration</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Output Section -->
        <div class="output-section" id="outputSection">
            <h2 class="section-title">Your Generated Content</h2>
            <div class="post-preview">
                <!-- <textarea class="post-content" id="postContent" placeholder="Your generated content will appear here..."></textarea> -->
                <div class="post-content" id="postContent" contenteditable="true" spellcheck="false"></div>
                <!-- Replace your div with: -->
                <!-- <div id="editorContainer">
                <div id="postContent"></div>
                </div> -->

            </div>
            <div class="post-actions">
                <button class="action-btn primary" onclick="copyToClipboard()">📋 Infographic</button>
                <button class="action-btn" id="exportPdfBtn">📄 Export PDF</button>
                <!-- ── INSERT IMAGE BUTTON HERE ── -->
                <button class="action-btn" id="insertImageBtn">🖼️ Insert Image</button>
                <!-- ──────────────────────────────── -->
                <button class="action-btn" onclick="regenerateContent()">🔄 Regenerate</button>
                <button class="action-btn" onclick="clearContent()">🗑️ Clear</button>
            </div>
            <!-- ── HIDDEN FILE INPUT FOR IMAGE UPLOAD ── -->
            <input type="file" id="imageInput" accept="image/*" style="display: none;" />
            <!-- ──────────────────────────────────────── -->
        </div>
    </div>
    <!-- quill library for html editor  -->
    <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
    <script src="https://cdn.quilljs.com/1.3.6/quill.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <!-- html2canvas for image export -->
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <script>
        // Global variables
        let selectedFormat = 'square';
        let currentPrompt = '';

        // Initialize particles
        function createParticles() {
            const particlesContainer = document.getElementById('particles');
            
            for (let i = 0; i < 50; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 20 + 's';
                particle.style.animationDuration = (Math.random() * 10 + 15) + 's';
                particlesContainer.appendChild(particle);
            }
        }

        // Initialize event listeners
        function initializeEventListeners() {
            // Post format selection
            document.querySelectorAll('.option-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.option-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    selectedFormat = this.dataset.format;
                });
            });

            // Generate button
            document.getElementById('generateBtn').addEventListener('click', generateContent);

            // Enter key in textarea
            document.getElementById('promptInput').addEventListener('keydown', function(e) {
                if (e.key === 'Enter' && e.ctrlKey) {
                    generateContent();
                }
            });
        }

        // Generate content function
        async function generateContent() {
            const promptInput = document.getElementById('promptInput');
            const generateBtn = document.getElementById('generateBtn');
            const btnText = generateBtn.querySelector('.btn-text');
            const loadingSpinner = document.getElementById('loadingSpinner');
            const outputSection = document.getElementById('outputSection');
            const postContent = document.getElementById('postContent');

            currentPrompt = promptInput.value.trim();

            if (!currentPrompt) {
                promptInput.focus();
                promptInput.style.borderColor = '#ff6b6b';
                setTimeout(() => {
                    promptInput.style.borderColor = 'rgba(255, 255, 255, 0.2)';
                }, 2000);
                return;
            }

            // Start loading state
            generateBtn.classList.add('loading');
            btnText.style.display = 'none';
            loadingSpinner.style.display = 'block';

            try {
                // Simulate API call with realistic delay 
                await new Promise(resolve => setTimeout(resolve, 2000 + Math.random() * 2000));

                const response = await mockApiCall(currentPrompt);
                const markdown_parsed_to_html = marked.parse(response.content);
                // Display result
                postContent.innerHTML = markdown_parsed_to_html // response.content;
                // Then turn it into a Quill editor:
                // const quill = new Quill('#postContent', {
                // theme: 'snow',
                // modules: { toolbar: [['bold','italic'], ['link'], [{ list: 'bullet' }]] }
                // });
                outputSection.classList.add('show');
                outputSection.scrollIntoView({ behavior: 'smooth', block: 'start' });

            } catch (error) {
                console.error('Error generating content:', error);
                alert('Failed to generate content. Please try again.');
            } finally {
                // End loading state
                generateBtn.classList.remove('loading');
                btnText.style.display = 'block';
                loadingSpinner.style.display = 'none';
            }
        }

        async function mockApiCall(prompt) {
            try {
                const res = await fetch('/generate', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ prompt })
                });

                if (!res.ok) {
                // network/server error (e.g. 500)
                const errText = await res.text();
                throw new Error(`Server responded ${res.status}: ${errText}`);
                }

                const data = await res.json();
                if (data.error) {
                // API-level error
                throw new Error(data.error);
                }

                // Return whatever you need downstream—here, the GPT raw result:
                return { content: data.result };
            } catch (err) {
                // Notify the user
                alert('Error: ' + err.message);

                // Re-throw if you want callers to catch it
                throw err;
            }
            }

            async function copyToClipboard() {
                const preview = document.querySelector('.post-preview');
                if (!preview) {
                    return alert('Nothing to capture!');
                }
                //////////////////////////
                // ── ① TEMPORARILY ADD WATERMARK ──
                const wm = document.createElement('div');
                wm.className = 'watermark';
                wm.innerText = 'GeniusPost AI';
                preview.appendChild(wm);
                //////////////////////////

                // 1. Override heading gradients as before
                const headings = preview.querySelectorAll('h1, h2, h3, h4, h5, h6');
                headings.forEach(h => {
                    h.dataset.origBg    = h.style.background;
                    h.dataset.origClip  = h.style.webkitBackgroundClip;
                    h.dataset.origColor = h.style.color;

                    h.style.background           = 'none';
                    h.style.webkitBackgroundClip = 'unset';
                    h.style.color                = '#fca5a5';
                });

                // 2. Temporarily override the preview background
                const origBg = preview.style.background;
                preview.style.background = 'linear-gradient(135deg, #2a2a3d, #1e1e2f)'; // dark purple–bluish
                // preview.style.background = 'linear-gradient(90deg, #9f5fd1 0%, #9f5fd1 50%, #00e5ff 50%, #00e5ff 100%)';

                // 3. Capture the full preview box
                try {
                    const canvas = await html2canvas(preview, {
                    backgroundColor: null, // let the inline style show
                    scale: 2
                    });
                    canvas.toBlob(blob => {
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = 'linkedin-post.png';
                    a.click();
                    URL.revokeObjectURL(url);
                    });
                } catch (err) {
                    console.error('Snapshot failed:', err);
                    alert('Unable to save snapshot.');
                }

                // 4. Restore original heading and preview background styles
                headings.forEach(h => {
                    h.style.background           = h.dataset.origBg;
                    h.style.webkitBackgroundClip = h.dataset.origClip;
                    h.style.color                = h.dataset.origColor;
                    delete h.dataset.origBg;
                    delete h.dataset.origClip;
                    delete h.dataset.origColor;
                });
                preview.style.background = origBg;
                // ── ④ REMOVE WATERMARK ──
                preview.removeChild(wm);
                }
// /////////////////////////////// PDF ////////////////////////////////////////////////////////////
        
            document.getElementById('exportPdfBtn').addEventListener('click', async () => {
            const preview = document.querySelector('.post-preview');
            if (!preview) return alert('Nothing to export!');
            // ── ① TEMPORARILY ADD WATERMARK ──
            const wm = document.createElement('div');
            wm.className = 'watermark';
            wm.innerText = 'GeniusPost AI';
            preview.appendChild(wm);

            // Temporarily override heading gradients (same as PNG fix)
            const headings = preview.querySelectorAll('h1, h2, h3, h4, h5, h6');
            headings.forEach(h => {
                h.dataset.origBg    = h.style.background;
                h.dataset.origClip  = h.style.webkitBackgroundClip;
                h.dataset.origColor = h.style.color;
                h.style.background           = 'none';
                h.style.webkitBackgroundClip = 'unset';
                h.style.color                = '#fca5a5';
            });

            // Temporarily darken background if needed
            const origBg = preview.style.background;
            preview.style.background = 'linear-gradient(135deg, #2a2a3d, #1e1e2f)';

            try {
                // 1. Render the entire preview to one tall canvas
                const canvas = await html2canvas(preview, { backgroundColor: null, scale: 2 });
                


                // 2. Export as PNG for perfect fidelity
                const imgData = canvas.toDataURL('image/png');

                // --- NEW: crop the tall canvas into A4‐sized page slices ---
                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF({ unit: 'px', format: 'a4' });
                const pdfW = pdf.internal.pageSize.getWidth();
                const pdfH = pdf.internal.pageSize.getHeight();

                // Compute the ratio of canvas→PDF widths
                const canvasW = canvas.width;
                const canvasH = canvas.height;
                const scale = (pdfW - 40) / canvasW; 
                const pageCanvasH = Math.floor(pdfH / scale);

                let renderedH = 0;
                while (renderedH < canvasH) {
                    // 5. Fill entire page with neon purple (or black). 
                    //    RGB for neon‐purple (#9f7aea) = (159, 122, 234).
                    pdf.setFillColor(159, 122, 234);
                    pdf.rect(0, 0, pdfW, pdfH, 'F');
                // Create a temp canvas for this page
                const tempCanvas = document.createElement('canvas');
                tempCanvas.width = canvasW;
                tempCanvas.height = Math.min(pageCanvasH, canvasH - renderedH);
                const tCtx = tempCanvas.getContext('2d');
                
                // Draw the slice
                tCtx.drawImage(
                    canvas,
                    0, renderedH,               // src x, y
                    canvasW, tempCanvas.height, // src w, h
                    0, 0,
                    canvasW, tempCanvas.height  // dst w, h
                );
                
                // Add to PDF
                const sliceData = tempCanvas.toDataURL('image/jpeg', 0.8);
                // pdf.addImage(sliceData, 'PNG', 20, 20, canvasW * scale, tempCanvas.height * scale);
                pdf.addImage(sliceData, 'JPEG', 20, 20, canvasW * scale, tempCanvas.height * scale);
                renderedH += pageCanvasH;
                if (renderedH < canvasH) pdf.addPage();
                }

                pdf.save('linkedin-post.pdf');

            } catch (e) {
                console.error('PDF export failed:', e);
                alert('Could not export multi-page PDF.');
            } finally {
                // ── ④ REMOVE WATERMARK ──
                preview.removeChild(wm);
                // Restore heading and preview bg
                headings.forEach(h => {
                h.style.background           = h.dataset.origBg;
                h.style.webkitBackgroundClip = h.dataset.origClip;
                h.style.color                = h.dataset.origColor;
                delete h.dataset.origBg;
                delete h.dataset.origClip;
                delete h.dataset.origColor;
                });
                preview.style.background = origBg;
            }
            });

            // NEW: EXPORT PDF USING WKHTMLTOPDF
//     document.getElementById('exportPdfBtn').addEventListener('click', async () => {
//       const preview = document.querySelector('.post-preview');
//       if (!preview) {
//         return alert('Nothing to export!');
//       }

//       // ── ① TEMPORARILY ADD WATERMARK ──
//       const wm = document.createElement('div');
//       wm.className = 'watermark';
//       wm.innerText = 'GeniusPost AI';
//       preview.appendChild(wm);

//       // Temporarily override heading gradients (same as PNG logic)
//       const headings = preview.querySelectorAll('h1, h2, h3, h4, h5, h6');
//       headings.forEach(h => {
//         h.dataset.origBg    = h.style.background;
//         h.dataset.origClip  = h.style.webkitBackgroundClip;
//         h.dataset.origColor = h.style.color;
//         h.style.background           = 'none';
//         h.style.webkitBackgroundClip = 'unset';
//         h.style.color                = '#fca5a5';
//       });

//       // Temporarily darken background
//       const origBg = preview.style.background;
//       preview.style.background = 'linear-gradient(135deg, #2a2a3d, #1e1e2f)'; 

//       try {
//         // ── GATHER THE FULL HTML FOR .post-preview ──
//         // We include a small <style> block with page-break rules.
//         const htmlToSend = `
// <!DOCTYPE html>
// <html lang="en">
// <head>
//   <meta charset="utf-8">
//   <title>LinkedIn Post PDF</title>
//   <style>
//   /* ───────────── IMPORT THE FONT ───────────── */
//   @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');

//   /* ───────────── FORCE PRINT COLORS & BACKGROUND ───────────── */
//   html, body {
//     height: 100%;
//     margin: 0;
//     padding: 0;
//     font-family: 'Inter', sans-serif;

//     /* ‹– purple gradient same as on-screen: */
//     background: linear-gradient(45deg, #0a0a0a, #1a1a2e, #16213e, #0f3460);
//     background-size: 400% 400%;

//     /* ‹– ensure wkhtmltopdf prints this gradient instead of white: */
//     -webkit-print-color-adjust: exact;  /* ‹– NEW */
//   }

//   /* ───────────── POST-PREVIEW CONTAINER ───────────── */
//   .post-preview {
//     background: rgba(0, 0, 0, 0.3);  /* 30% black over the purple gradient */
//     border-radius: 15px;
//     padding: 30px;
//     border: 1px solid rgba(255, 255, 255, 0.2);
//     position: relative;
//     margin-bottom: 20px;
//     display: block;
//     page-break-inside: avoid;

//     /* ‹– force any semi-transparent fills to print exactly over the gradient */
//     -webkit-print-color-adjust: exact;  /* ‹– NEW */
//   }

//   /* ───────────── WATERMARK ───────────── */
//   .watermark {
//     position: absolute;
//     top: 10px;
//     right: 10px;
//     opacity: 1.0;
//     font-size: 1.1rem;
//     font-weight: 800;
//     color: #d0b8d8;
//     pointer-events: none;
//     user-select: none;
//     z-index: 5;

//     /* ‹– ensure the watermark itself doesn’t fade: */
//     -webkit-print-color-adjust: exact;  /* ‹– NEW */
//   }

//   /* ───────────── PAGE-BREAK PROTECTION ───────────── */
//   .post-preview,
//   .post-preview pre,
//   .post-preview code,
//   .post-preview table,
//   .post-preview thead,
//   .post-preview tbody,
//   .post-preview tr,
//   .post-preview ul,
//   .post-preview ol,
//   .post-preview blockquote {
//     page-break-inside: avoid;
//   }

//   /* ───────────── HEADING STYLES ───────────── */
//   .post-preview h1,
//   .post-preview h2,
//   .post-preview h3,
//   .post-preview h4,
//   .post-preview h5,
//   .post-preview h6 {
//     position: relative;
//     margin: 1.5rem 0 1rem;
//     font-weight: 700;
//     background: linear-gradient(45deg, #d8b4fe, #fca5a5, #fde68a);
//     background-clip: text;
//     -webkit-background-clip: text;
//     color: transparent;

//     /* headings render as gradient text (no need for print‐color‐adjust here because the gradient is just text‐fill) */
//   }

//   /* ───────────── CODE-BLOCK STYLES ───────────── */
//   .post-preview pre {
//     background: #111;  /* solid black so that 30% opacity over the gradient shows correctly */
//     color: #a3d9ff;    /* soft neon blue text */
//     font-family: 'Source Code Pro', monospace;
//     font-size: 0.95rem;
//     padding: 1rem 1.25rem;
//     border-radius: 0.75rem;
//     border: 2px solid rgba(163, 217, 255, 0.6);
//     box-shadow:
//       0 0 8px rgba(163, 217, 255, 0.4),
//       inset 0 0 6px rgba(163, 217, 255, 0.2);
//     margin: 1.25rem 0;
//     overflow-x: auto;

//     /* ‹– ensure this block prints exactly as above */
//     -webkit-print-color-adjust: exact;  /* ‹– NEW */
//   }

//   .post-preview code {
//     background: #111;
//     color: #a3d9ff;
//     font-family: 'Source Code Pro', monospace;
//     font-size: 0.95rem;
//     padding: 1rem 1.25rem;
//     border-radius: 0.75rem;
//     border: 2px solid rgba(163, 217, 255, 0.6);
//     box-shadow:
//       0 0 8px rgba(163, 217, 255, 0.4),
//       inset 0 0 6px rgba(163, 217, 255, 0.2);
//     margin: 1.25rem 0;
//     display: block;
//     overflow-x: auto;

//     -webkit-print-color-adjust: exact;  /* ‹– NEW */
//   }

//   /* ───────────── TABLE STYLES ───────────── */
//   .post-preview table {
//     width: 100%;
//     border-collapse: separate;
//     border-spacing: 0;
//     margin: 2rem 0;
//     border: 2px solid rgba(102,126,234,0.8);
//     box-shadow: 0 0 20px rgba(102,126,234,0.6);
//     border-radius: 1rem;
//     overflow: hidden;

//     -webkit-print-color-adjust: exact;  /* ‹– NEW */
//   }

//   .post-preview th,
//   .post-preview td {
//     padding: 1rem 1.5rem;
//     border: 1px solid rgba(102,126,234,0.3);

//     -webkit-print-color-adjust: exact;  /* ‹– NEW */
//   }

//   .post-preview th {
//     background: linear-gradient(90deg, #667eea, #764ba2);
//     color: #fff;
//     text-align: left;
//     text-shadow: 0 0 8px rgba(255,255,255,0.6);

//     -webkit-print-color-adjust: exact;  /* ‹– NEW */
//   }

//   .post-preview tr:nth-child(even) td {
//     background: rgba(102,126,234,0.05);

//     -webkit-print-color-adjust: exact;  /* ‹– NEW */
//   }

//   /* ───────────── LIST STYLES ───────────── */
//   .post-preview ul,
//   .post-preview ol {
//     margin: 1rem 0 1rem 1.5rem;
//     line-height: 1.6;
//     -webkit-print-color-adjust: exact;  /* ‹– NEW */
//   }

//   .post-preview li {
//     margin-bottom: 0.5rem;
//     position: relative;

//     -webkit-print-color-adjust: exact;  /* ‹– NEW */
//   }

//   .post-preview ul li::marker {
//     color: #fca5a5;
//     font-size: 1.2rem;

//     -webkit-print-color-adjust: exact;  /* ‹– NEW */
//   }

//   .post-preview ol li {
//     counter-increment: section;
//     -webkit-print-color-adjust: exact;  /* ‹– NEW */
//   }

//   .post-preview ol li::before {
//     content: counter(section) '. ';
//     position: absolute;
//     left: -1.5rem;
//     color: #d8b4fe;

//     -webkit-print-color-adjust: exact;  /* ‹– NEW */
//   }

//   /* ───────────── INLINE CODE ───────────── */
//   .post-preview p code {
//     background: rgba(255,255,255,0.1);
//     color: #ffeb3b;
//     padding: 0.2rem 0.4rem;
//     border-radius: 0.5rem;
//     box-shadow: 0 0 4px rgba(255,235,59,0.4);

//     -webkit-print-color-adjust: exact;  /* ‹– NEW */
//   }

//   /* ───────────── IMAGE STYLES ───────────── */
//   .post-preview img {
//     max-width: 100%;
//     border-radius: 0.75rem;
//     box-shadow: 0 8px 20px rgba(0,0,0,0.4);
//     margin: 1rem 0;

//     -webkit-print-color-adjust: exact;  /* ‹– NEW */
//   }
// </style>

// </head>
// <body>
//   ${preview.outerHTML}
// </body>
// </html>`;

//         // ② SEND TO /generate-pdf BACKEND
//         const response = await fetch('/generate-pdf', {
//           method: 'POST',
//           headers: { 'Content-Type': 'application/json' },
//           body: JSON.stringify({ html: htmlToSend })
//         });

//         if (!response.ok) {
//           const errText = await response.text();
//           throw new Error(`Server responded ${response.status}: ${errText}`);
//         }

//         // ③ DOWNLOAD THE PDF
//         const blob = await response.blob();
//         const url = URL.createObjectURL(blob);
//         const a = document.createElement('a');
//         a.href = url;
//         a.download = 'linkedin-post.pdf';
//         document.body.appendChild(a);
//         a.click();
//         document.body.removeChild(a);
//         URL.revokeObjectURL(url);
//       } catch (e) {
//         console.error('PDF export failed:', e);
//         alert('Could not export PDF.');
//       } finally {
//         // ── REMOVE WATERMARK & RESTORE BG/HEADINGS ──
//         preview.removeChild(wm);
//         headings.forEach(h => {
//           h.style.background           = h.dataset.origBg;
//           h.style.webkitBackgroundClip = h.dataset.origClip;
//           h.style.color                = h.dataset.origColor;
//           delete h.dataset.origBg;
//           delete h.dataset.origClip;
//           delete h.dataset.origColor;
//         });
//         preview.style.background = origBg;
//       }
//     });



            

        // ///////////////////////////////////////////////////////////////////////////////////////
                function regenerateContent() {
                    if (currentPrompt) {
                        generateContent();
                    }
                }

                function clearContent() {
                    document.getElementById('postContent').value = '';
                    document.getElementById('outputSection').classList.remove('show');
                    document.getElementById('promptInput').value = '';
                    currentPrompt = '';
                }

                // Initialize everything when DOM loads
                document.addEventListener('DOMContentLoaded', function() {
                    createParticles();
                    initializeEventListeners();
                });

                // Add some interactive hover effects
                document.addEventListener('mousemove', function(e) {
                    const particles = document.querySelectorAll('.particle');
                    particles.forEach(particle => {
                        const speed = Math.random() * 2 + 1;
                        const x = (e.clientX * speed) / 100;
                        const y = (e.clientY * speed) / 100;
                        
                        particle.style.transform = `translateX(${x}px) translateY(${y}px)`;
                    });
                });

    ////////////////////////////////////Image/////////////////////////////////
        document
      .getElementById('insertImageBtn')
      .addEventListener('click', () => {
        document.getElementById('imageInput').click();
    });

    document
      .getElementById('imageInput')
      .addEventListener('change', async (event) => {
        const file = event.target.files[0];
        if (!file) return;
        if (!file.type.startsWith('image/')) {
          alert('Please select an image file.');
          return;
        }
        const reader = new FileReader();
        reader.onload = () => {
          const imgDataUrl = reader.result;
          const img = document.createElement('img');
          img.src = imgDataUrl;
          img.style.maxWidth = '100%';
          img.style.margin = '1rem 0';
          img.style.borderRadius = '0.75rem';
          img.style.boxShadow = '0 4px 12px rgba(0,0,0,0.3)';
          
          const postDiv = document.getElementById('postContent');
          postDiv.appendChild(img);
          postDiv.appendChild(document.createElement('br'));
          event.target.value = '';
        };
        reader.readAsDataURL(file);
    });
    </script>
</body>
</html>